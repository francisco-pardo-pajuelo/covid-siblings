*- PISA

*https://webfs.oecd.org/pisa2022/index.html
/*

//





*/


capture program drop main 
program define main 

	setup_PISA
	
	import_data_2000
	import_data_2003
	import_data_2006
	import_data_2009
	import_data_2012
	import_data_2015
	import_data_2018
	import_data_2022
	
	import_data_2018_D //Pisa for LMIC

	append_years
	
	descriptive
	
	analyze_2009_2012_vs_2022
	analyze_2018_D_vs_2022	
end


capture program drop setup_PISA
program define setup_PISA

	di "SETUP"
	
	colorpalette  HCL blues, selec(2 5 8 11) nograph
	return list

	global blue_1 = "`r(p1)'"
	global blue_2 = "`r(p2)'"
	global blue_3 = "`r(p3)'"
	global blue_4 = "`r(p4)'"
	
	colorpalette  HCL reds, selec(2 5 8 11) nograph
	return list

	global red_1 = "`r(p1)'"
	global red_2 = "`r(p2)'"
	global red_3 = "`r(p3)'"	
	global red_4 = "`r(p4)'"	
	
		colorpalette  HCL greens, selec(2 5 8 11) nograph
	return list

	global green_1 = "`r(p1)'"
	global green_2 = "`r(p2)'"
	global green_3 = "`r(p3)'"		
	global green_4 = "`r(p4)'"
	
	
end

capture program drop import_data_2000 
program define import_data_2000 

di "2000"

end


capture program drop import_data_2003
program define import_data_2003

di "2003"

end

capture program drop import_data_2006
program define import_data_2006

di "2006"

end

capture program drop import_data_2009
program define import_data_2009


	clear
	set more off

	*-----------------------------*
	* 1. Import fixed-width data  *
	*-----------------------------*

	infix ///
		str3   CNT         1-3 ///
		str3   COUNTRY     4-6 ///
		byte   OECD        7 ///
		str5   SUBNATIO    8-12 ///
		str5   SCHOOLID    13-17 ///
		str5   StIDStd     18-22 ///
		byte   ST01Q01     23-24 ///
		byte   ST02Q01     25-26 ///
		str2   ST03Q02     27-28 ///
		str4   ST03Q03     29-32 ///
		byte   ST04Q01     33 ///
		byte   ST05Q01     34 ///
		int    ST06Q01     35-39 ///
		byte   ST07Q01     40 ///
		byte   ST07Q02     41 ///
		byte   ST07Q03     42 ///
		byte   ST08Q01     43 ///
		byte   ST08Q02     44 ///
		byte   ST08Q03     45 ///
		byte   ST08Q04     46 ///
		byte   ST08Q05     47 ///
		byte   ST08Q06     48 ///
		str4   ST09Q01     49-52 ///
		byte   ST10Q01     53 ///
		byte   ST11Q01     54 ///
		byte   ST11Q02     55 ///
		byte   ST11Q03     56 ///
		byte   ST11Q04     57 ///
		byte   ST12Q01     58 ///
		str4   ST13Q01     59-62 ///
		byte   ST14Q01     63 ///
		byte   ST15Q01     64 ///
		byte   ST15Q02     65 ///
		byte   ST15Q03     66 ///
		byte   ST15Q04     67 ///
		byte   ST16Q01     68 ///
		byte   ST17Q01     69 ///
		byte   ST17Q02     70 ///
		byte   ST17Q03     71 ///
		int    ST18Q01     72-76 ///
		byte   ST19Q01     77 ///
		byte   ST20Q01     78 ///
		byte   ST20Q02     79 ///
		byte   ST20Q03     80 ///
		byte   ST20Q04     81 ///
		byte   ST20Q05     82 ///
		byte   ST20Q06     83 ///
		byte   ST20Q07     84 ///
		byte   ST20Q08     85 ///
		byte   ST20Q09     86 ///
		byte   ST20Q10     87 ///
		float   ESCS       556  -  564 ///
		float 	PV1MATH    745  -  752  ///
		float 	PV2MATH    753  -  760  ///
		float 	PV3MATH    761  -  768  ///
		float 	PV4MATH    769  -  776  ///
		float 	PV5MATH    777  -  784  ///
		float 	PV1READ    785  -  792  ///
		float 	PV2READ    793  -  800  ///
		float 	PV3READ    801  -  808  ///
		float 	PV4READ    809  -  816  ///
		float 	PV5READ    817  -  824  ///
		float 	PV1SCIE    825  -  832  ///
		float 	PV2SCIE    833  -  840  ///
		float 	PV3SCIE    841  -  848  ///
		float 	PV4SCIE    849  -  856  ///
		float 	PV5SCIE    857  -  864  ///
		float 	PV1READ1   865  -  872  ///
		float 	PV2READ1   873  -  880  ///
		float 	PV3READ1   881  -  888  ///
		float 	PV4READ1   889  -  896  ///
		float 	PV5READ1   897  -  904  ///
		float 	PV1READ2   905  -  912  ///
		float 	PV2READ2   913  -  920  ///
		float 	PV3READ2   921  -  928  ///
		float 	PV4READ2   929  -  936  ///
		float 	PV5READ2   937  -  944  ///
		float 	PV1READ3   945  -  952  ///
		float 	PV2READ3   953  -  960  ///
		float 	PV3READ3   961  -  968  ///
		float 	PV4READ3   969  -  976  ///
		float 	PV5READ3   977  -  984  ///
		float 	PV1READ4   985  -  992  ///
		float 	PV2READ4   993  -  1000 ///
		float 	PV3READ4   1001  -  1008	///
		float 	PV4READ4   1009  -  1016	///
		float 	PV5READ4   1017  -  1024	///
		float 	PV1READ5   1025  -  1032	///
		float 	PV2READ5   1033  -  1040	///
		float 	PV3READ5   1041  -  1048	///
		float 	PV4READ5   1049  -  1056	///
		float 	PV5READ5   1057  -  1064	///
		float	CNTFAC     1797  -  1804 	///
		using "$IN\PISA\2009\INT_STQ09_DEC11.txt"

	*-----------------------------*
	* 2. Variable Labels          *
	*-----------------------------*

	label variable CNT      "Country code 3-character"
	label variable COUNTRY  "Country code ISO 3-digit"
	label variable OECD     "OECD country"
	label variable SUBNATIO "Adjudicated sub-region"
	label variable SCHOOLID "School ID 5-digit"
	label variable StIDStd  "Student ID 5-digit"
	label variable ST01Q01  "Grade"
	label variable ST02Q01  "<Programme>"
	label variable ST03Q02  "Birth Month"
	label variable ST03Q03  "Birth Year"
	label variable ST04Q01  "Sex"
	label variable ST05Q01  "Attend <ISCED 0>"

	*-----------------------------*
	* 3. Value Labels             *
	*-----------------------------*
	/*
	label define CNT_lbl ///
		"ALB" "Albania" ///
		"ARG" "Argentina" ///
		"AUS" "Australia" ///
		"AUT" "Austria" ///
		"AZE" "Azerbaijan" ///
		"BEL" "Belgium" ///
		"BRA" "Brazil" ///
		"BGR" "Bulgaria" ///
		"CAN" "Canada" ///
		"CHL" "Chile" ///
		"USA" "United States" 
	label values CNT CNT_lbl

	label define COUNTRY_lbl ///
		"008" "Albania" ///
		"032" "Argentina" ///
		"036" "Australia" ///
		"040" "Austria" ///
		"056" "Belgium" ///
		"076" "Brazil" ///
		"124" "Canada" ///
		"152" "Chile" ///
		"840" "United States"
	label values COUNTRY COUNTRY_lbl
*/

	*-------------------------------*
	* 		Has siblings			*	
	*-------------------------------*
	
	*- Who usually lives at home with you?	
	gen sibs = .
	replace sibs = 0 if inlist(ST08Q03,1,2)==1 	| inlist(ST08Q04,1,2)==1 //Defined if yes/no at least for one.
	replace sibs = 1 if inlist(ST08Q03,1)==1 	| inlist(ST08Q04,1)==1 //Defined as YES if yes at least for one.

	*-------------------------------*
	* 		Rename					*	
	*-------------------------------*	
	
	rename CNTFAC SENWT
	
	*-----------------------------*
	* 4. Save the dataset         *
	*-----------------------------*


	destring COUNTRY, replace
	rename COUNTRY CNTRYID
	gen year = 2009
	compress	
	
	save "$TEMP\COVID\pisa_student_2009.dta", replace


end

capture program drop import_data_2012
program define import_data_2012

*************************************
* PISA Student Data Import Do-file
* Generated from SPSS syntax: SPSS syntax to read in student questionnaire data file.txt
*************************************

	clear
	set more off

	*************************************
	* PISA Student Data Import Do-file
	* Generated from SPSS syntax: SPSS syntax to read in student questionnaire data file.txt
	*************************************

	*-----------------------------*
	* 1. Import fixed-width data  *
	*-----------------------------*

infix ///
    str3    CNT          1-3 ///
    str7    SUBNATIO     4-10 ///
    str7    STRATUM      11-17 ///
    byte    OECD         18-18 ///
    str6    NC           19-24 ///
    str7    SCHOOLID     25-31 ///
    str5    StIDStd      32-36 ///
    int     ST01Q01      37-38 ///
    int     ST02Q01      39-40 ///
    str2    ST03Q01      41-42 ///
    str4    ST03Q02      43-46 ///
    byte    ST04Q01      47-47 ///
    byte    ST05Q01      48-48 ///
    int     ST06Q01      49-52 ///
    byte    ST07Q01      53-53 ///
    byte    ST07Q02      54-54 ///
    byte    ST07Q03      55-55 ///
    byte    ST08Q01      56-56 ///
    byte    ST09Q01      57-57 ///
    byte    ST115Q01     58-58 ///
    byte    ST11Q01      59-59 ///
    byte    ST11Q02      60-60 ///
    byte    ST11Q03      61-61 ///
    byte    ST11Q04      62-62 ///
    byte    ST11Q05      63-63 ///
    byte    ST11Q06      64-64 ///
    byte    ST13Q01      65-65 ///
    byte    ST14Q01      66-66 ///
    byte    ST14Q02      67-67 ///
    byte    ST14Q03      68-68 ///
    byte    ST14Q04      69-69 ///
    byte    ST15Q01      70-70 ///
    byte    ST17Q01      71-71 ///
    byte    ST18Q01      72-72 ///
    byte    ST18Q02      73-73 ///
    byte    ST18Q03      74-74 ///
    byte    ST18Q04      75-75 ///
    byte    ST19Q01      76-76 ///
    byte    ST20Q01      77-77 ///
    byte    ST20Q02      78-78 ///
    byte    ST20Q03      79-79 ///
    int     ST21Q01      80-83 ///
    byte    ST25Q01      84-84 ///
    byte    ST26Q01      85-85 ///
    byte    ST26Q02      86-86 ///
    byte    ST26Q03      87-87 ///
    byte    ST26Q04      88-88 ///
    byte    ST26Q05      89-89 ///
    byte    ST26Q06      90-90 ///
    byte    ST26Q07      91-91 ///
    byte    ST26Q08      92-92 ///
    byte    ST26Q09      93-93 ///
    byte    ST26Q10      94-94 ///
    byte    ST26Q11      95-95 ///
    byte    ST26Q12      96-96 ///
    byte    ST26Q13      97-97 ///
    byte    ST26Q14      98-98 ///
    str7    ST26Q15      99-105 ///
    str7    ST26Q16      106-112 ///
    str7    ST26Q17      113-119 ///
    byte    ST27Q01      120-120 ///
    byte    ST27Q02      121-121 ///
    byte    ST27Q03      122-122 ///
    byte    ST27Q04      123-123 ///
    byte    ST27Q05      124-124 ///
    byte    ST28Q01      125-125 ///
    byte    ST29Q01      126-126 ///
    byte    ST29Q02      127-127 ///
    byte    ST29Q03      128-128 ///
    byte    ST29Q04      129-129 ///
    byte    ST29Q05      130-130 ///
    byte    ST29Q06      131-131 ///
    byte    ST29Q07      132-132 ///
    byte    ST29Q08      133-133 ///
    byte    ST35Q01      134-134 ///
    byte    ST35Q02      135-135 ///
    byte    ST35Q03      136-136 ///
    byte    ST35Q04      137-137 ///
    byte    ST35Q05      138-138 ///
    byte    ST35Q06      139-139 ///
    byte    ST37Q01      140-140 ///
    byte    ST37Q02      141-141 ///
    byte    ST37Q03      142-142 ///
    byte    ST37Q04      143-143 ///
    byte    ST37Q05      144-144 ///
    byte    ST37Q06      145-145 ///
    byte    ST37Q07      146-146 ///
    byte    ST37Q08      147-147 ///
    byte    ST42Q01      148-148 ///
    byte    ST42Q02      149-149 ///
    byte    ST42Q03      150-150 ///
    byte    ST42Q04      151-151 ///
    byte    ST42Q05      152-152 ///
    byte    ST42Q06      153-153 ///
    byte    ST42Q07      154-154 ///
    byte    ST42Q08      155-155 ///
    byte    ST42Q09      156-156 ///
    byte    ST42Q10      157-157 ///
    byte    ST43Q01      158-158 ///
    byte    ST43Q02      159-159 ///
    byte    ST43Q03      160-160 ///
    byte    ST43Q04      161-161 ///
    byte    ST43Q05      162-162 ///
    byte    ST43Q06      163-163 ///
    byte    ST44Q01      164-164 ///
    byte    ST44Q03      165-165 ///
    byte    ST44Q04      166-166 ///
    byte    ST44Q05      167-167 ///
    byte    ST44Q07      168-168 ///
    byte    ST44Q08      169-169 ///
    byte    ST46Q01      170-170 ///
    byte    ST46Q02      171-171 ///
    byte    ST46Q03      172-172 ///
    byte    ST46Q04      173-173 ///
    byte    ST46Q05      174-174 ///
    byte    ST46Q06      175-175 ///
    byte    ST46Q07      176-176 ///
    byte    ST46Q08      177-177 ///
    byte    ST46Q09      178-178 ///
    byte    ST48Q01      179-179 ///
    byte    ST48Q02      180-180 ///
    byte    ST48Q03      181-181 ///
    byte    ST48Q04      182-182 ///
    byte    ST48Q05      183-183 ///
    byte    ST49Q01      184-184 ///
    byte    ST49Q02      185-185 ///
    byte    ST49Q03      186-186 ///
    byte    ST49Q04      187-187 ///
    byte    ST49Q05      188-188 ///
    byte    ST49Q06      189-189 ///
    byte    ST49Q07      190-190 ///
    byte    ST49Q09      191-191 ///
    byte    ST53Q01      192-192 ///
    byte    ST53Q02      193-193 ///
    byte    ST53Q03      194-194 ///
    byte    ST53Q04      195-195 ///
    byte    ST55Q01      196-196 ///
    byte    ST55Q02      197-197 ///
    byte    ST55Q03      198-198 ///
    byte    ST55Q04      199-199 ///
    int     ST57Q01      200-203 ///
    int     ST57Q02      204-207 ///
    int     ST57Q03      208-211 ///
    int     ST57Q04      212-215 ///
    int     ST57Q05      216-219 ///
    int     ST57Q06      220-223 ///
    byte    ST61Q01      224-224 ///
    byte    ST61Q02      225-225 ///
    byte    ST61Q03      226-226 ///
    byte    ST61Q04      227-227 ///
    byte    ST61Q05      228-228 ///
    byte    ST61Q06      229-229 ///
    byte    ST61Q07      230-230 ///
    byte    ST61Q08      231-231 ///
    byte    ST61Q09      232-232 ///
    byte    ST62Q01      233-233 ///
    byte    ST62Q02      234-234 ///
    byte    ST62Q03      235-235 ///
    byte    ST62Q04      236-236 ///
    byte    ST62Q06      237-237 ///
    byte    ST62Q07      238-238 ///
    byte    ST62Q08      239-239 ///
    byte    ST62Q09      240-240 ///
    byte    ST62Q10      241-241 ///
    byte    ST62Q11      242-242 ///
    byte    ST62Q12      243-243 ///
    byte    ST62Q13      244-244 ///
    byte    ST62Q15      245-245 ///
    byte    ST62Q16      246-246 ///
    byte    ST62Q17      247-247 ///
    byte    ST62Q19      248-248 ///
    int     ST69Q01      249-252 ///
    int     ST69Q02      253-256 ///
    int     ST69Q03      257-260 ///
    int     ST70Q01      261-264 ///
    int     ST70Q02      265-268 ///
    int     ST70Q03      269-272 ///
    int     ST71Q01      273-276 ///
    int     ST72Q01      277-280 ///
    byte    ST73Q01      281-281 ///
    byte    ST73Q02      282-282 ///
    byte    ST74Q01      283-283 ///
    byte    ST74Q02      284-284 ///
    byte    ST75Q01      285-285 ///
    byte    ST75Q02      286-286 ///
    byte    ST76Q01      287-287 ///
    byte    ST76Q02      288-288 ///
    byte    ST77Q01      289-289 ///
    byte    ST77Q02      290-290 ///
    byte    ST77Q04      291-291 ///
    byte    ST77Q05      292-292 ///
    byte    ST77Q06      293-293 ///
    byte    ST79Q01      294-294 ///
    byte    ST79Q02      295-295 ///
    byte    ST79Q03      296-296 ///
    byte    ST79Q04      297-297 ///
    byte    ST79Q05      298-298 ///
    byte    ST79Q06      299-299 ///
    byte    ST79Q07      300-300 ///
    byte    ST79Q08      301-301 ///
    byte    ST79Q10      302-302 ///
    byte    ST79Q11      303-303 ///
    byte    ST79Q12      304-304 ///
    byte    ST79Q15      305-305 ///
    byte    ST79Q17      306-306 ///
    byte    ST80Q01      307-307 ///
    byte    ST80Q04      308-308 ///
    byte    ST80Q05      309-309 ///
    byte    ST80Q06      310-310 ///
    byte    ST80Q07      311-311 ///
    byte    ST80Q08      312-312 ///
    byte    ST80Q09      313-313 ///
    byte    ST80Q10      314-314 ///
    byte    ST80Q11      315-315 ///
    byte    ST81Q01      316-316 ///
    byte    ST81Q02      317-317 ///
    byte    ST81Q03      318-318 ///
    byte    ST81Q04      319-319 ///
    byte    ST81Q05      320-320 ///
    byte    ST82Q01      321-321 ///
    byte    ST82Q02      322-322 ///
    byte    ST82Q03      323-323 ///
    byte    ST83Q01      324-324 ///
    byte    ST83Q02      325-325 ///
    byte    ST83Q03      326-326 ///
    byte    ST83Q04      327-327 ///
    byte    ST84Q01      328-328 ///
    byte    ST84Q02      329-329 ///
    byte    ST84Q03      330-330 ///
    byte    ST85Q01      331-331 ///
    byte    ST85Q02      332-332 ///
    byte    ST85Q03      333-333 ///
    byte    ST85Q04      334-334 ///
    byte    ST86Q01      335-335 ///
    byte    ST86Q02      336-336 ///
    byte    ST86Q03      337-337 ///
    byte    ST86Q04      338-338 ///
    byte    ST86Q05      339-339 ///
    byte    ST87Q01      340-340 ///
    byte    ST87Q02      341-341 ///
    byte    ST87Q03      342-342 ///
    byte    ST87Q04      343-343 ///
    byte    ST87Q05      344-344 ///
    byte    ST87Q06      345-345 ///
    byte    ST87Q07      346-346 ///
    byte    ST87Q08      347-347 ///
    byte    ST87Q09      348-348 ///
    byte    ST88Q01      349-349 ///
    byte    ST88Q02      350-350 ///
    byte    ST88Q03      351-351 ///
    byte    ST88Q04      352-352 ///
    byte    ST89Q02      353-353 ///
    byte    ST89Q03      354-354 ///
    byte    ST89Q04      355-355 ///
    byte    ST89Q05      356-356 ///
    byte    ST91Q01      357-357 ///
    byte    ST91Q02      358-358 ///
    byte    ST91Q03      359-359 ///
    byte    ST91Q04      360-360 ///
    byte    ST91Q05      361-361 ///
    byte    ST91Q06      362-362 ///
    byte    ST93Q01      363-363 ///
    byte    ST93Q03      364-364 ///
    byte    ST93Q04      365-365 ///
    byte    ST93Q06      366-366 ///
    byte    ST93Q07      367-367 ///
    byte    ST94Q05      368-368 ///
    byte    ST94Q06      369-369 ///
    byte    ST94Q09      370-370 ///
    byte    ST94Q10      371-371 ///
    byte    ST94Q14      372-372 ///
    byte    ST96Q01      373-373 ///
    byte    ST96Q02      374-374 ///
    byte    ST96Q03      375-375 ///
    byte    ST96Q05      376-376 ///
    byte    ST101Q01     377-377 ///
    byte    ST101Q02     378-378 ///
    byte    ST101Q03     379-379 ///
    byte    ST101Q05     380-380 ///
    byte    ST104Q01     381-381 ///
    byte    ST104Q04     382-382 ///
    byte    ST104Q05     383-383 ///
    byte    ST104Q06     384-384 ///
    byte    IC01Q01      385-385 ///
    byte    IC01Q02      386-386 ///
    byte    IC01Q03      387-387 ///
    byte    IC01Q04      388-388 ///
    byte    IC01Q05      389-389 ///
    byte    IC01Q06      390-390 ///
    byte    IC01Q07      391-391 ///
    byte    IC01Q08      392-392 ///
    byte    IC01Q09      393-393 ///
    byte    IC01Q10      394-394 ///
    byte    IC01Q11      395-395 ///
    byte    IC02Q01      396-396 ///
    byte    IC02Q02      397-397 ///
    byte    IC02Q03      398-398 ///
    byte    IC02Q04      399-399 ///
    byte    IC02Q05      400-400 ///
    byte    IC02Q06      401-401 ///
    byte    IC02Q07      402-402 ///
    byte    IC03Q01      403-403 ///
    byte    IC04Q01      404-404 ///
    str2    IC05Q01      405-406 ///
    str2    IC06Q01      407-408 ///
    str2    IC07Q01      409-410 ///
    byte    IC08Q01      411-411 ///
    byte    IC08Q02      412-412 ///
    byte    IC08Q03      413-413 ///
    byte    IC08Q04      414-414 ///
    byte    IC08Q05      415-415 ///
    byte    IC08Q06      416-416 ///
    byte    IC08Q07      417-417 ///
    byte    IC08Q08      418-418 ///
    byte    IC08Q09      419-419 ///
    byte    IC08Q11      420-420 ///
    byte    IC09Q01      421-421 ///
    byte    IC09Q02      422-422 ///
    byte    IC09Q03      423-423 ///
    byte    IC09Q04      424-424 ///
    byte    IC09Q05      425-425 ///
    byte    IC09Q06      426-426 ///
    byte    IC09Q07      427-427 ///
    byte    IC10Q01      428-428 ///
    byte    IC10Q02      429-429 ///
    byte    IC10Q03      430-430 ///
    byte    IC10Q04      431-431 ///
    byte    IC10Q05      432-432 ///
    byte    IC10Q06      433-433 ///
    byte    IC10Q07      434-434 ///
    byte    IC10Q08      435-435 ///
    byte    IC10Q09      436-436 ///
    byte    IC11Q01      437-437 ///
    byte    IC11Q02      438-438 ///
    byte    IC11Q03      439-439 ///
    byte    IC11Q04      440-440 ///
    byte    IC11Q05      441-441 ///
    byte    IC11Q06      442-442 ///
    byte    IC11Q07      443-443 ///
    byte    IC22Q01      444-444 ///
    byte    IC22Q02      445-445 ///
    byte    IC22Q04      446-446 ///
    byte    IC22Q06      447-447 ///
    byte    IC22Q07      448-448 ///
    byte    IC22Q08      449-449 ///
    byte    EC01Q01      450-450 ///
    byte    EC02Q01      451-451 ///
    byte    EC03Q01      452-452 ///
    byte    EC03Q02      453-453 ///
    byte    EC03Q03      454-454 ///
    byte    EC03Q04      455-455 ///
    byte    EC03Q05      456-456 ///
    byte    EC03Q06      457-457 ///
    byte    EC03Q07      458-458 ///
    byte    EC03Q08      459-459 ///
    byte    EC03Q09      460-460 ///
    byte    EC03Q10      461-461 ///
    byte    EC04Q01A     462-462 ///
    byte    EC04Q01B     463-463 ///
    byte    EC04Q01C     464-464 ///
    byte    EC04Q02A     465-465 ///
    byte    EC04Q02B     466-466 ///
    byte    EC04Q02C     467-467 ///
    byte    EC04Q03A     468-468 ///
    byte    EC04Q03B     469-469 ///
    byte    EC04Q03C     470-470 ///
    byte    EC04Q04A     471-471 ///
    byte    EC04Q04B     472-472 ///
    byte    EC04Q04C     473-473 ///
    byte    EC04Q05A     474-474 ///
    byte    EC04Q05B     475-475 ///
    byte    EC04Q05C     476-476 ///
    byte    EC04Q06A     477-477 ///
    byte    EC04Q06B     478-478 ///
    byte    EC04Q06C     479-479 ///
    byte    EC05Q01      480-480 ///
    byte    EC06Q01      481-481 ///
    byte    EC07Q01      482-482 ///
    byte    EC07Q02      483-483 ///
    byte    EC07Q03      484-484 ///
    byte    EC07Q04      485-485 ///
    byte    EC07Q05      486-486 ///
    byte    EC08Q01      487-487 ///
    byte    EC08Q02      488-488 ///
    byte    EC08Q03      489-489 ///
    byte    EC08Q04      490-490 ///
    byte    EC09Q03      491-491 ///
    byte    EC10Q01      492-492 ///
    byte    EC11Q02      493-493 ///
    byte    EC11Q03      494-494 ///
    byte    EC12Q01      495-495 ///
    byte    ST22Q01      496-496 ///
    byte    ST23Q01      497-497 ///
    byte    ST23Q02      498-498 ///
    byte    ST23Q03      499-499 ///
    byte    ST23Q04      500-500 ///
    byte    ST23Q05      501-501 ///
    byte    ST23Q06      502-502 ///
    byte    ST23Q07      503-503 ///
    byte    ST23Q08      504-504 ///
    byte    ST24Q01      505-505 ///
    byte    ST24Q02      506-506 ///
    byte    ST24Q03      507-507 ///
    byte    CLCUSE1      508-508 ///
    str2    CLCUSE301    509-510 ///
    str2    CLCUSE302    511-512 ///
    str2    Deffort      513-514 ///
    byte    QuestID      515-515 ///
    int     Bookid       516-517 ///
    byte    EASY         518-518 ///
    long    AGE          519-526 ///
    int     GRADE        527-528 ///
    str8    progn        529-536 ///
    long    ANXMAT       537-544 ///
    long    ATSCHL       545-552 ///
    double  ATTLNACT     553-561 ///
    long    BELONG       562-569 ///
    long    BFMJ2        570-574 ///
    long    BMMJ1        575-579 ///
    double  CLSMAN       580-588 ///
    str6    COBN_F       589-594 ///
    str6    COBN_M       595-600 ///
    str6    COBN_S       601-606 ///
    double  COGACT       607-615 ///
    double  CULTDIST     616-624 ///
    long    CULTPOS      625-632 ///
    long    DISCLIMA     633-640 ///
    double  ENTUSE       641-649 ///
    long    ESCS         650-657 ///
    double  EXAPPLM      658-666 ///
    double  EXPUREM      667-675 ///
    double  FAILMAT      676-684 ///
    double  FAMCON       685-693 ///
    long    FAMCONC      694-701 ///
    byte    FAMSTRUC     702-702 ///
    byte    fisced       703-703 ///
    long    HEDRES       704-711 ///
    double  HERITCUL     712-720 ///
    byte    hisced       721-721 ///
    long    hisei        722-729 ///
    long    HOMEPOS      730-737 ///
    double  HOMSCH       738-746 ///
    double  HOSTCUL      747-755 ///
    double  ICTATTNEG    756-764 ///
    double  ICTATTPOS    765-773 ///
    double  ICTHOME      774-782 ///
    double  ICTSCH       783-791 ///
    byte    IMMIG        792-792 ///
    double  INFOCAR      793-801 ///
    double  INFOJOB1     802-810 ///
    double  INFOJOB2     811-819 ///
    long    INSTMOT      820-827 ///
    long    INTMAT       828-835 ///
    byte    iscedd       836-836 ///
    byte    iscedl       837-837 ///
    byte    iscedo       838-838 ///
    byte    LANGCOMM     839-839 ///
    str3    LANGN        840-842 ///
    byte    LANGRPPD     843-843 ///
    int     LMINS        844-847 ///
    double  MATBEH       848-856 ///
    long    MATHEFF      857-864 ///
    double  MATINTFC     865-873 ///
    double  MATWKETH     874-882 ///
    byte    misced       883-883 ///
    int     MMINS        884-887 ///
    double  MTSUP        888-896 ///
    str4    OCOD1        897-900 ///
    str4    OCOD2        901-904 ///
    double  OPENPS       905-913 ///
    long    OUTHOURS     914-921 ///
    long    PARED        922-929 ///
    double  PERSEV       930-938 ///
    byte    REPEAT       939-939 ///
    long    SCMAT        940-947 ///
    int     SMINS        948-951 ///
    long    STUDREL      952-959 ///
    double  SUBNORM      960-968 ///
    double  TCHBEHFA     969-977 ///
    double  TCHBEHSO     978-986 ///
    double  TCHBEHTD     987-995 ///
    long    TEACHSUP     996-1003 ///
    str3    TestLANG     1004-1006 ///
    double  TIMEINT      1007-1015 ///
    double  USEMATH      1016-1024 ///
    double  USESCH       1025-1033 ///
    long    WEALTH       1034-1041 ///
    double  ANCATSCHL    1042-1050 ///
    double  ANCATTLNACT  1051-1059 ///
    double  ANCBELONG    1060-1068 ///
    double  ANCCLSMAN    1069-1077 ///
    double  ANCCOGACT    1078-1086 ///
    double  ANCINSTMOT   1087-1095 ///
    double  ANCINTMAT    1096-1104 ///
    double  ANCMATWKETH  1105-1113 ///
    double  ANCMTSUP     1114-1122 ///
    double  ANCSCMAT     1123-1131 ///
    double  ANCSTUDREL   1132-1140 ///
    double  ANCSUBNORM   1141-1149 ///
    double  PV1MATH      1150-1158 ///
    double  PV2MATH      1159-1167 ///
    double  PV3MATH      1168-1176 ///
    double  PV4MATH      1177-1185 ///
    double  PV5MATH      1186-1194 ///
    double  PV1MACC      1195-1203 ///
    double  PV2MACC      1204-1212 ///
    double  PV3MACC      1213-1221 ///
    double  PV4MACC      1222-1230 ///
    double  PV5MACC      1231-1239 ///
    double  PV1MACQ      1240-1248 ///
    double  PV2MACQ      1249-1257 ///
    double  PV3MACQ      1258-1266 ///
    double  PV4MACQ      1267-1275 ///
    double  PV5MACQ      1276-1284 ///
    double  PV1MACS      1285-1293 ///
    double  PV2MACS      1294-1302 ///
    double  PV3MACS      1303-1311 ///
    double  PV4MACS      1312-1320 ///
    double  PV5MACS      1321-1329 ///
    double  PV1MACU      1330-1338 ///
    double  PV2MACU      1339-1347 ///
    double  PV3MACU      1348-1356 ///
    double  PV4MACU      1357-1365 ///
    double  PV5MACU      1366-1374 ///
    double  PV1MAPE      1375-1383 ///
    double  PV2MAPE      1384-1392 ///
    double  PV3MAPE      1393-1401 ///
    double  PV4MAPE      1402-1410 ///
    double  PV5MAPE      1411-1419 ///
    double  PV1MAPF      1420-1428 ///
    double  PV2MAPF      1429-1437 ///
    double  PV3MAPF      1438-1446 ///
    double  PV4MAPF      1447-1455 ///
    double  PV5MAPF      1456-1464 ///
    double  PV1MAPI      1465-1473 ///
    double  PV2MAPI      1474-1482 ///
    double  PV3MAPI      1483-1491 ///
    double  PV4MAPI      1492-1500 ///
    double  PV5MAPI      1501-1509 ///
    double  PV1READ      1510-1518 ///
    double  PV2READ      1519-1527 ///
    double  PV3READ      1528-1536 ///
    double  PV4READ      1537-1545 ///
    double  PV5READ      1546-1554 ///
    double  PV1SCIE      1555-1563 ///
    double  PV2SCIE      1564-1572 ///
    double  PV3SCIE      1573-1581 ///
    double  PV4SCIE      1582-1590 ///
    double  PV5SCIE      1591-1599 ///
    double  W_FSTUWT     1600-1608 ///
    double  W_FSTR1      1609-1617 ///
    double  W_FSTR2      1618-1626 ///
    double  W_FSTR3      1627-1635 ///
    double  W_FSTR4      1636-1644 ///
    double  W_FSTR5      1645-1653 ///
    double  W_FSTR6      1654-1662 ///
    double  W_FSTR7      1663-1671 ///
    double  W_FSTR8      1672-1680 ///
    double  W_FSTR9      1681-1689 ///
    double  W_FSTR10     1690-1698 ///
    double  W_FSTR11     1699-1707 ///
    double  W_FSTR12     1708-1716 ///
    double  W_FSTR13     1717-1725 ///
    double  W_FSTR14     1726-1734 ///
    double  W_FSTR15     1735-1743 ///
    double  W_FSTR16     1744-1752 ///
    double  W_FSTR17     1753-1761 ///
    double  W_FSTR18     1762-1770 ///
    double  W_FSTR19     1771-1779 ///
    double  W_FSTR20     1780-1788 ///
    double  W_FSTR21     1789-1797 ///
    double  W_FSTR22     1798-1806 ///
    double  W_FSTR23     1807-1815 ///
    double  W_FSTR24     1816-1824 ///
    double  W_FSTR25     1825-1833 ///
    double  W_FSTR26     1834-1842 ///
    double  W_FSTR27     1843-1851 ///
    double  W_FSTR28     1852-1860 ///
    double  W_FSTR29     1861-1869 ///
    double  W_FSTR30     1870-1878 ///
    double  W_FSTR31     1879-1887 ///
    double  W_FSTR32     1888-1896 ///
    double  W_FSTR33     1897-1905 ///
    double  W_FSTR34     1906-1914 ///
    double  W_FSTR35     1915-1923 ///
    double  W_FSTR36     1924-1932 ///
    double  W_FSTR37     1933-1941 ///
    double  W_FSTR38     1942-1950 ///
    double  W_FSTR39     1951-1959 ///
    double  W_FSTR40     1960-1968 ///
    double  W_FSTR41     1969-1977 ///
    double  W_FSTR42     1978-1986 ///
    double  W_FSTR43     1987-1995 ///
    double  W_FSTR44     1996-2004 ///
    double  W_FSTR45     2005-2013 ///
    double  W_FSTR46     2014-2022 ///
    double  W_FSTR47     2023-2031 ///
    double  W_FSTR48     2032-2040 ///
    double  W_FSTR49     2041-2049 ///
    double  W_FSTR50     2050-2058 ///
    double  W_FSTR51     2059-2067 ///
    double  W_FSTR52     2068-2076 ///
    double  W_FSTR53     2077-2085 ///
    double  W_FSTR54     2086-2094 ///
    double  W_FSTR55     2095-2103 ///
    double  W_FSTR56     2104-2112 ///
    double  W_FSTR57     2113-2121 ///
    double  W_FSTR58     2122-2130 ///
    double  W_FSTR59     2131-2139 ///
    double  W_FSTR60     2140-2148 ///
    double  W_FSTR61     2149-2157 ///
    double  W_FSTR62     2158-2166 ///
    double  W_FSTR63     2167-2175 ///
    double  W_FSTR64     2176-2184 ///
    double  W_FSTR65     2185-2193 ///
    double  W_FSTR66     2194-2202 ///
    double  W_FSTR67     2203-2211 ///
    double  W_FSTR68     2212-2220 ///
    double  W_FSTR69     2221-2229 ///
    double  W_FSTR70     2230-2238 ///
    double  W_FSTR71     2239-2247 ///
    double  W_FSTR72     2248-2256 ///
    double  W_FSTR73     2257-2265 ///
    double  W_FSTR74     2266-2274 ///
    double  W_FSTR75     2275-2283 ///
    double  W_FSTR76     2284-2292 ///
    double  W_FSTR77     2293-2301 ///
    double  W_FSTR78     2302-2310 ///
    double  W_FSTR79     2311-2319 ///
    double  W_FSTR80     2320-2328 ///
    int     WVARSTRR     2329-2330 ///
    int     VAR_UNIT     2331-2332 ///
    double  senwgt_STU   2333-2341 ///
    str7    VER_STU      2342-2348 ///
		using "$IN\PISA\2012\INT_STU12_DEC03.txt", clear



	*-----------------------------*
	* 2. Variable Labels          *
	*-----------------------------*
	capture label variable NC			"National Centre 6-digit Code"
	capture label variable CNT			"Country code 3-character" 
	capture label variable OECD			"OECD country" 
	capture label variable SUBNATIO		"Adjudicated sub-region code 7-digit code (3-digit country code + region ID + stratum ID)"
	capture label variable STRATUM		"Stratum ID 7-character (cnt + region ID + original stratum ID)"
	capture label variable SCHOOLID		"School ID 7-digit (region ID + stratum ID + 3-digit school ID)"
	capture label variable STIDSTD		"Student ID" 
	capture label variable ST01Q01		"International Grade"
	capture label variable ST02Q01		"National Study Programme"
	capture label variable ST03Q01		"Birth - Month"
	capture label variable ST03Q02		"Birth -Year"
	capture label variable ST04Q01		"Gender"
	capture label variable ST05Q01		"Attend <ISCED 0>"
	capture label variable ST06Q01		"Age at <ISCED 1>" 
	capture label variable ST07Q01		"Repeat - <ISCED 1>"
	capture label variable ST07Q02		"Repeat - <ISCED 2>"
	capture label variable ST07Q03		"Repeat - <ISCED 3>"
	capture label variable ST08Q01		"Truancy - Late for School"
	capture label variable ST09Q01		"Truancy - Skip whole school day"
	capture label variable ST115Q01		"Truancy - Skip classes within school day" 
	capture label variable ST11Q01		"At Home - Mother" 
	capture label variable ST11Q02		"At Home - Father" 
	capture label variable ST11Q03		"At Home - Brothers" 
	capture label variable ST11Q04		"At Home - Sisters" 
	capture label variable ST11Q05		"At Home - Grandparents" 
	capture label variable ST11Q06		"At Home - Others" 
	capture label variable ST13Q01		"Mother<Highest Schooling>"
	capture label variable ST14Q01		"Mother Qualifications - <ISCED level 6>" 
	capture label variable ST14Q02		"Mother Qualifications - <ISCED level 5A>"
	capture label variable ST14Q03		"Mother Qualifications - <ISCED level 5B>"
	capture label variable ST14Q04		"Mother Qualifications - <ISCED level 4>" 
	capture label variable ST15Q01		"Mother Current Job Status" 
	capture label variable ST17Q01		"Father<Highest Schooling>" 
	capture label variable ST18Q01		"Father Qualifications - <ISCED level 6>" 
	capture label variable ST18Q02		"Father Qualifications - <ISCED level 5A>"
	capture label variable ST18Q03		"Father Qualifications - <ISCED level 5B>"
	capture label variable ST18Q04		"Father Qualifications - <ISCED level 4>" 
	capture label variable ST19Q01		"Father Current Job Status" 
	capture label variable ST20Q01		"Country of Birth - Self" 
	capture label variable ST20Q02		"Country of Birth - Mother" 
	capture label variable ST20Q03		"Country of Birth - Father" 
	capture label variable ST21Q01		"Age of arrival in <country of test>" 
	capture label variable ST25Q01		"International Language at Home"
	capture label variable ST26Q01		"Possessions - desk" 
	capture label variable ST26Q02		"Possessions - own room" 
	capture label variable ST26Q03		"Possessions - study place" 
	capture label variable ST26Q04		"Possessions - computer" 
	capture label variable ST26Q05		"Possessions - software" 
	capture label variable ST26Q06		"Possessions - Internet" 
	capture label variable ST26Q07		"Possessions - literature" 
	capture label variable ST26Q08		"Possessions - poetry" 
	capture label variable ST26Q09		"Possessions - art" 
	capture label variable ST26Q10		"Possessions - textbooks" 
	capture label variable ST26Q11		"Possessions - <technical reference books>" 
	capture label variable ST26Q12		"Possessions - dictionary" 
	capture label variable ST26Q13		"Possessions - dishwasher" 
	capture label variable ST26Q14		"Possessions - <DVD>" 
	capture label variable ST26Q15		"Possessions - <Country item 1>" 
	capture label variable ST26Q16		"Possessions - <Country item 2>" 
	capture label variable ST26Q17		"Possessions - <Country item 3>" 
	capture label variable ST27Q01		"How many - cellular phones" 
	capture label variable ST27Q02		"How many - televisions" 
	capture label variable ST27Q03		"How many - computers" 
	capture label variable ST27Q04		"How many - cars" 
	capture label variable ST27Q05		"How many - rooms bath or shower" 
	capture label variable ST28Q01		"How many books at home" 
	capture label variable ST29Q01		"Maths Interest - Enjoy Reading" 
	capture label variable ST29Q02		"Instrumental Motivation - Worthwhile for Work" 
	capture label variable ST29Q03		"Maths Interest - Look Forward to Lessons" 
	capture label variable ST29Q04		"Maths Interest - Enjoy Maths" 
	capture label variable ST29Q05		"Instrumental Motivation - Worthwhile for Career Chances" 
	capture label variable ST29Q06		"Maths Interest - Interested" 
	capture label variable ST29Q07		"Instrumental Motivation - importnt for Future Study" 
	capture label variable ST29Q08		"Instrumental Motivation - Helps to Get a Job" 
	capture label variable ST35Q01		"Subjective Norms - Friends Do Well in Mathematics" 
	capture label variable ST35Q02		"Subjective Norms - Friends Work Hard on Mathematics" 
	capture label variable ST35Q03		"Subjective Norms - Friends Enjoy Mathematics Tests" 
	capture label variable ST35Q04		"Subjective Norms - Parents Believe Studying Mathematics Is importnt" 
	capture label variable ST35Q05		"Subjective Norms - Parents Believe Mathematics Is importnt for Career" 
	capture label variable ST35Q06		"Subjective Norms - Parents Like Mathematics" 
	capture label variable ST37Q01		"Maths Self-Efficacy - Using a <Train Timetable>" 
	capture label variable ST37Q02		"Maths Self-Efficacy - Calculating TV Discount" 
	capture label variable ST37Q03		"Maths Self-Efficacy - Calculating Square Metres of Tiles" 
	capture label variable ST37Q04		"Maths Self-Efficacy - Understanding Graphs in Newspapers" 
	capture label variable ST37Q05		"Maths Self-Efficacy - Solving Equation 1" 
	capture label variable ST37Q06		"Maths Self-Efficacy - Distance to Scale" 
	capture label variable ST37Q07		"Maths Self-Efficacy - Solving Equation 2" 
	capture label variable ST37Q08		"Maths Self-Efficacy - Calculate Petrol Consumption Rate" 
	capture label variable ST42Q01		"Maths Anxiety - Worry That It Will Be Difficult" 
	capture label variable ST42Q02		"Maths Self-Concept - Not Good at Maths" 
	capture label variable ST42Q03		"Maths Anxiety - Get Very Tense" 
	capture label variable ST42Q04		"Maths Self-Concept - Get Good <Grades>" 
	capture label variable ST42Q05		"Maths Anxiety - Get Very Nervous" 
	capture label variable ST42Q06		"Maths Self-Concept - Learn Quickly" 
	capture label variable ST42Q07		"Maths Self-Concept - One of Best Subjects" 
	capture label variable ST42Q08		"Maths Anxiety - Feel Helpless" 
	capture label variable ST42Q09		"Maths Self-Concept - Understand Difficult Work" 
	capture label variable ST42Q10		"Maths Anxiety - Worry About Getting Poor <Grades>" 
	capture label variable ST43Q01		"Perceived Control - Can Succeed with Enough Effort" 
	capture label variable ST43Q02		"Perceived Control - Doing Well is Completely Up to Me" 
	capture label variable ST43Q03		"Perceived Control - Family Demands and Problems" 
	capture label variable ST43Q04		"Perceived Control - Different Teachers" 
	capture label variable ST43Q05		"Perceived Control - If I Wanted I Could Perform Well" 
	capture label variable ST43Q06		"Perceived Control - Perform Poorly Regardless" 
	capture label variable ST44Q01		"Attributions to Failure - Not Good at Maths Problems" 
	capture label variable ST44Q03		"Attributions to Failure - Teacher Did Not Explain Well" 
	capture label variable ST44Q04		"Attributions to Failure - Bad Guesses" 
	capture label variable ST44Q05		"Attributions to Failure - Material Too Hard" 
	capture label variable ST44Q07		"Attributions to Failure - Teacher Didnt Get Students Interested" 
	capture label variable ST44Q08		"Attributions to Failure - Unlucky" 
	capture label variable ST46Q01		"Maths Work Ethic - Homework Completed in Time" 
	capture label variable ST46Q02		"Maths Work Ethic - Work Hard on Homework" 
	capture label variable ST46Q03		"Maths Work Ethic - Prepared for Exams" 
	capture label variable ST46Q04		"Maths Work Ethic - Study Hard for Quizzes" 
	capture label variable ST46Q05		"Maths Work Ethic - Study Until I Understand Everything" 
	capture label variable ST46Q06		"Maths Work Ethic - Pay Attention in Classes" 
	capture label variable ST46Q07		"Maths Work Ethic - Listen in Classes" 
	capture label variable ST46Q08		"Maths Work Ethic - Avoid Distractions When Studying" 
	capture label variable ST46Q09		"Maths Work Ethic - Keep Work Organized" 
	capture label variable ST48Q01		"Maths Intentions - Mathematics vs. Language Courses After School" 
	capture label variable ST48Q02		"Maths Intentions - Mathematics vs. Science Related Major in College" 
	capture label variable ST48Q03		"Maths Intentions - Study Harder in Mathematics vs. Language Classes" 
	capture label variable ST48Q04		"Maths Intentions - Take Maximum Number of Mathematics vs. Science Classes" 
	capture label variable ST48Q05		"Maths Intentions - Pursuing a Career That Involves Mathematics vs. Science" 
	capture label variable ST49Q01		"Maths Behaviour - Talk about Maths with Friends" 
	capture label variable ST49Q02		"Maths Behaviour - Help Friends with Maths" 
	capture label variable ST49Q03		"Maths Behaviour - <Extracurricular> Activity" 
	capture label variable ST49Q04		"Maths Behaviour - Participate in Competitions" 
	capture label variable ST49Q05		"Maths Behaviour - Study More Than 2 Extra Hours a Day" 
	capture label variable ST49Q06		"Maths Behaviour - Play Chess" 
	capture label variable ST49Q07		"Maths Behaviour - Computer programming" 
	capture label variable ST49Q09		"Maths Behaviour - Participate in Maths Club" 
	capture label variable ST53Q01		"Learning Strategies - importnt Parts vs. Existing Knowledge vs. Learn by Heart" 
	capture label variable ST53Q02		"Learning Strategies - Improve Understanding vs. New Ways vs. Memory" 
	capture label variable ST53Q03		"Learning Strategies - Other Subjects vs. Learning Goals vs. Rehearse Problems" 
	capture label variable ST53Q04		"Learning Strategies - Repeat Examples vs. Everyday Applications vs. More Information" 
	capture label variable ST55Q01		"Out of school lessons - <test lang>" 
	capture label variable ST55Q02		"Out of school lessons - <maths>" 
	capture label variable ST55Q03		"Out of school lessons - <science>" 
	capture label variable ST55Q04		"Out of school lessons - other" 
	capture label variable ST57Q01		"Out-of-School Study Time - Homework" 
	capture label variable ST57Q02		"Out-of-School Study Time - Guided Homework" 
	capture label variable ST57Q03		"Out-of-School Study Time - Personal Tutor" 
	capture label variable ST57Q04		"Out-of-School Study Time - Commercial Company" 
	capture label variable ST57Q05		"Out-of-School Study Time - With Parent" 
	capture label variable ST57Q06		"Out-of-School Study Time - Computer" 
	capture label variable ST61Q01		"Experience with Applied Maths Tasks - Use <Train Timetable>" 
	capture label variable ST61Q02		"Experience with Applied Maths Tasks - Calculate Price including Tax" 
	capture label variable ST61Q03		"Experience with Applied Maths Tasks - Calculate Square Metres" 
	capture label variable ST61Q04		"Experience with Applied Maths Tasks - Understand Scientific Tables" 
	capture label variable ST61Q05		"Experience with Pure Maths Tasks - Solve Equation 1" 
	capture label variable ST61Q06		"Experience with Applied Maths Tasks - Use a Map to Calculate Distance" 
	capture label variable ST61Q07		"Experience with Pure Maths Tasks - Solve Equation 2" 
	capture label variable ST61Q08		"Experience with Applied Maths Tasks - Calculate Power Consumption Rate" 
	capture label variable ST61Q09		"Experience with Applied Maths Tasks - Solve Equation 3" 
	capture label variable ST62Q01		"Familiarity with Maths Concepts - Exponential Function" 
	capture label variable ST62Q02		"Familiarity with Maths Concepts - Divisor" 
	capture label variable ST62Q03		"Familiarity with Maths Concepts - Quadratic Function" 
	capture label variable ST62Q04		"Overclaiming - Proper Number" 
	capture label variable ST62Q06		"Familiarity with Maths Concepts - Linear Equation" 
	capture label variable ST62Q07		"Familiarity with Maths Concepts - Vectors" 
	capture label variable ST62Q08		"Familiarity with Maths Concepts - Complex Number" 
	capture label variable ST62Q09		"Familiarity with Maths Concepts - Rational Number" 
	capture label variable ST62Q10		"Familiarity with Maths Concepts - Radicals" 
	capture label variable ST62Q11		"Overclaiming - Subjunctive Scaling" 
	capture label variable ST62Q12		"Familiarity with Maths Concepts - Polygon" 
	capture label variable ST62Q13		"Overclaiming - Declarative Fraction" 
	capture label variable ST62Q15		"Familiarity with Maths Concepts - Congruent Figure" 
	capture label variable ST62Q16		"Familiarity with Maths Concepts - Cosine" 
	capture label variable ST62Q17		"Familiarity with Maths Concepts - Arithmetic Mean" 
	capture label variable ST62Q19		"Familiarity with Maths Concepts - Probability" 
	capture label variable ST69Q01		"Min in <class period> - <test lang>" 
	capture label variable ST69Q02		"Min in <class period> - <Maths>" 
	capture label variable ST69Q03		"Min in <class period> - <Science>" 
	capture label variable ST70Q01		"No of <class period> p/wk - <test lang>" 
	capture label variable ST70Q02		"No of <class period> p/wk - <Maths>" 
	capture label variable ST70Q03		"No of <class period> p/wk - <Science>" 
	capture label variable ST71Q01		"No of ALL <class period> a week" 
	capture label variable ST72Q01		"Class Size - No of Students in <Test Language> Class" 
	capture label variable ST73Q01		"OTL - Algebraic Word Problem in Maths Lesson" 
	capture label variable ST73Q02		"OTL - Algebraic Word Problem in Tests" 
	capture label variable ST74Q01		"OTL - Procedural Task in Maths Lesson" 
	capture label variable ST74Q02		"OTL - Procedural Task in Tests" 
	capture label variable ST75Q01		"OTL - Pure Maths Reasoning in Maths Lesson" 
	capture label variable ST75Q02		"OTL - Pure Maths Reasoning in Tests" 
	capture label variable ST76Q01		"OTL - Applied Maths Reasoning in Maths Lesson" 
	capture label variable ST76Q02		"OTL - Applied Maths Reasoning in Tests" 
	capture label variable ST77Q01		"Maths Teaching - Teacher shows interest" 
	capture label variable ST77Q02		"Maths Teaching - Extra help" 
	capture label variable ST77Q04		"Maths Teaching - Teacher helps" 
	capture label variable ST77Q05		"Maths Teaching - Teacher continues" 
	capture label variable ST77Q06		"Maths Teaching - Express opinions" 
	capture label variable ST79Q01		"Teacher-Directed Instruction - Sets Clear Goals" 
	capture label variable ST79Q02		"Teacher-Directed Instruction - Encourages Thinking and Reasoning" 
	capture label variable ST79Q03		"Student Orientation - Differentiates Between Students When Giving Tasks" 
	capture label variable ST79Q04		"Student Orientation - Assigns Complex Projects" 
	capture label variable ST79Q05		"Formative Assessment - Gives Feedback" 
	capture label variable ST79Q06		"Teacher-Directed Instruction - Checks Understanding" 
	capture label variable ST79Q07		"Student Orientation - Has Students Work in Small Groups" 
	capture label variable ST79Q08		"Teacher-Directed Instruction - Summarizes Previous Lessons" 
	capture label variable ST79Q10		"Student Orientation - Plans Classroom Activities" 
	capture label variable ST79Q11		"Formative Assessment - Gives Feedback on Strengths and Weaknesses" 
	capture label variable ST79Q12		"Formative Assessment - Informs about Expectations" 
	capture label variable ST79Q15		"Teacher-Directed Instruction - Informs about Learning Goals" 
	capture label variable ST79Q17		"Formative Assessment - Tells How to Get Better" 
	capture label variable ST80Q01		"Cognitive Activation - Teacher Encourages to Reflect Problems" 
	capture label variable ST80Q04		"Cognitive Activation - Gives Problems that Require to Think" 
	capture label variable ST80Q05		"Cognitive Activation - Asks to Use Own Procedures" 
	capture label variable ST80Q06		"Cognitive Activation - Presents Problems with No Obvious Solutions" 
	capture label variable ST80Q07		"Cognitive Activation - Presents Problems in Different Contexts" 
	capture label variable ST80Q08		"Cognitive Activation - Helps Learn from Mistakes" 
	capture label variable ST80Q09		"Cognitive Activation - Asks for Explanations" 
	capture label variable ST80Q10		"Cognitive Activation - Apply What We Learned" 
	capture label variable ST80Q11		"Cognitive Activation - Problems with Multiple Solutions" 
	capture label variable ST81Q01		"Disciplinary Climate - Students Don t Listen" 
	capture label variable ST81Q02		"Disciplinary Climate - Noise and Disorder" 
	capture label variable ST81Q03		"Disciplinary Climate - Teacher Has to Wait Until its Quiet" 
	capture label variable ST81Q04		"Disciplinary Climate - Students Don t Work Well" 
	capture label variable ST81Q05		"Disciplinary Climate - Students Start Working Late" 
	capture label variable ST82Q01		"Vignette Teacher Support - Homework Every Other Day/Back in Time" 
	capture label variable ST82Q02		"Vignette Teacher Support - Homework Once a Week/Back in Time" 
	capture label variable ST82Q03		"Vignette Teacher Support - Homework Once a Week/Not Back in Time" 
	capture label variable ST83Q01		"Teacher Support - Lets Us Know We Have to Work Hard" 
	capture label variable ST83Q02		"Teacher Support - Provides Extra Help When Needed" 
	capture label variable ST83Q03		"Teacher Support - Helps Students with Learning" 
	capture label variable ST83Q04		"Teacher Support - Gives Opportunity to Express Opinions" 
	capture label variable ST84Q01		"Vignette Classroom Management - Students Frequently Interrupt/Teacher Arrives Early" 
	capture label variable ST84Q02		"Vignette Classroom Management - Students Are Calm/Teacher Arrives on Time" 
	capture label variable ST84Q03		"Vignette Classroom Management - Students Frequently Interrupt/Teacher Arrives Late" 
	capture label variable ST85Q01		"Classroom Management - Students Listen" 
	capture label variable ST85Q02		"Classroom Management - Teacher Keeps Class Orderly" 
	capture label variable ST85Q03		"Classroom Management - Teacher Starts On Time" 
	capture label variable ST85Q04		"Classroom Management - Wait Long to <Quiet Down>" 
	capture label variable ST86Q01		"Student-Teacher Relations - Get Along with Teachers" 
	capture label variable ST86Q02		"Student-Teacher Relations - Teachers Are Interested" 
	capture label variable ST86Q03		"Student-Teacher Relations - Teachers Listen to Students" 
	capture label variable ST86Q04		"Student-Teacher Relations - Teachers Help Students" 
	capture label variable ST86Q05		"Student-Teacher Relations - Teachers Treat Students Fair" 
	capture label variable ST87Q01		"Sense of Belonging - Feel Like Outsider" 
	capture label variable ST87Q02		"Sense of Belonging - Make Friends Easily" 
	capture label variable ST87Q03		"Sense of Belonging - Belong at School" 
	capture label variable ST87Q04		"Sense of Belonging - Feel Awkward at School" 
	capture label variable ST87Q05		"Sense of Belonging - Liked by Other Students" 
	capture label variable ST87Q06		"Sense of Belonging - Feel Lonely at School" 
	capture label variable ST87Q07		"Sense of Belonging - Feel Happy at School" 
	capture label variable ST87Q08		"Sense of Belonging - Things Are Ideal at School" 
	capture label variable ST87Q09		"Sense of Belonging - Satisfied at School" 
	capture label variable ST88Q01		"Attitude towards School - Does Little to Prepare Me for Life" 
	capture label variable ST88Q02		"Attitude towards School - Waste of Time" 
	capture label variable ST88Q03		"Attitude towards School - Gave Me Confidence" 
	capture label variable ST88Q04		"Attitude towards School - Useful for Job" 
	capture label variable ST89Q02		"Attitude toward School - Helps to Get a Job" 
	capture label variable ST89Q03		"Attitude toward School - Prepare for College" 
	capture label variable ST89Q04		"Attitude toward School - Enjoy Good Grades" 
	capture label variable ST89Q05		"Attitude toward School - Trying Hard is importnt" 
	capture label variable ST91Q01		"Perceived Control - Can Succeed with Enough Effort" 
	capture label variable ST91Q02		"Perceived Control - My Choice Whether I Will Be Good" 
	capture label variable ST91Q03		"Perceived Control - Problems Prevent from Putting Effort into School"
	capture label variable ST91Q04		"Perceived Control - Different Teachers Would Make Me Try Harder" 
	capture label variable ST91Q05		"Perceived Control - Could Perform Well if I Wanted" 
	capture label variable ST91Q06		"Perceived Control - Perform Poor Regardless" 
	capture label variable ST93Q01		"Perseverance - Give up easily" 
	capture label variable ST93Q03		"Perseverance - Put off difficult problems" 
	capture label variable ST93Q04		"Perseverance - Remain interested" 
	capture label variable ST93Q06		"Perseverance - Continue to perfection" 
	capture label variable ST93Q07		"Perseverance - Exceed expectations" 
	capture label variable ST94Q05		"Openness for Problem Solving - Can Handle a Lot of Information" 
	capture label variable ST94Q06		"Openness for Problem Solving - Quick to Understand" 
	capture label variable ST94Q09		"Openness for Problem Solving - Seek Explanations" 
	capture label variable ST94Q10		"Openness for Problem Solving - Can Link Facts" 
	capture label variable ST94Q14		"Openness for Problem Solving - Like to Solve Complex Problems" 
	capture label variable ST96Q01		"Problem Text Message - Press every button" 
	capture label variable ST96Q02		"Problem Text Message - Trace steps" 
	capture label variable ST96Q03		"Problem Text Message - Manual" 
	capture label variable ST96Q05		"Problem Text Message - Ask a friend" 
	capture label variable ST101Q01		"Problem Route Selection - Read brochure" 
	capture label variable ST101Q02		"Problem Route Selection - Study map" 
	capture label variable ST101Q03		"Problem Route Selection - Leave it to brother" 
	capture label variable ST101Q05		"Problem Route Selection - Just drive" 
	capture label variable ST104Q01		"Problem Ticket Machine - Similarities" 
	capture label variable ST104Q04		"Problem Ticket Machine - Try buttons" 
	capture label variable ST104Q05		"Problem Ticket Machine - Ask for help" 
	capture label variable ST104Q06		"Problem Ticket Machine - Find ticket office" 
	capture label variable IC01Q01		"At Home - Desktop Computer" 
	capture label variable IC01Q02		"At Home - Portable laptop" 
	capture label variable IC01Q03		"At Home - Tablet computer" 
	capture label variable IC01Q04		"At Home - Internet connection" 
	capture label variable IC01Q05		"At Home - Video games console" 
	capture label variable IC01Q06		"At Home - Cell phone w/o Internet" 
	capture label variable IC01Q07		"At Home - Cell phone with Internet" 
	capture label variable IC01Q08		"At Home - Mp3/Mp4 player" 
	capture label variable IC01Q09		"At Home - Printer" 
	capture label variable IC01Q10		"At Home - USB (memory) stick" 
	capture label variable IC01Q11		"At Home - Ebook reader" 
	capture label variable IC02Q01		"At school - Desktop Computer" 
	capture label variable IC02Q02		"At school - Portable laptop" 
	capture label variable IC02Q03		"At school - Tablet computer" 
	capture label variable IC02Q04		"At school - Internet connection" 
	capture label variable IC02Q05		"At school - Printer" 
	capture label variable IC02Q06		"At school - USB (memory) stick" 
	capture label variable IC02Q07		"At school - Ebook reader" 
	capture label variable IC03Q01		"First use of computers" 
	capture label variable IC04Q01		"First access to Internet" 
	capture label variable IC05Q01		"Internet at School" 
	capture label variable IC06Q01		"Internet out-of-school - Weekday" 
	capture label variable IC07Q01		"Internet out-of-school - Weekend" 
	capture label variable IC08Q01		"Out-of-school 8 - One player games." 
	capture label variable IC08Q02		"Out-of-school 8 - ColLabourative games." 
	capture label variable IC08Q03		"Out-of-school 8 - Use email" 
	capture label variable IC08Q04		"Out-of-school 8 - Chat on line" 
	capture label variable IC08Q05		"Out-of-school 8 - Social networks" 
	capture label variable IC08Q06		"Out-of-school 8 - Browse the Internet for fun" 
	capture label variable IC08Q07		"Out-of-school 8 - Read news" 
	capture label variable IC08Q08		"Out-of-school 8 - Obtain practical information from the Internet"
	capture label variable IC08Q09		"Out-of-school 8 - Download music" 
	capture label variable IC08Q11		"Out-of-school 8 - Upload content" 
	capture label variable IC09Q01		"Out-of-school 9 - Internet for school" 
	capture label variable IC09Q02		"Out-of-school 9 - Email students" 
	capture label variable IC09Q03		"Out-of-school 9 - Email teachers" 
	capture label variable IC09Q04		"Out-of-school 9 - Download from School" 
	capture label variable IC09Q05		"Out-of-school 9 - Announcements" 
	capture label variable IC09Q06		"Out-of-school 9 - Homework" 
	capture label variable IC09Q07		"Out-of-school 9 - Share school material" 
	capture label variable IC10Q01		"At School - Chat on line" 
	capture label variable IC10Q02		"At School - Email" 
	capture label variable IC10Q03		"At School - Browse for schoolwork" 
	capture label variable IC10Q04		"At School - Download from website" 
	capture label variable IC10Q05		"At School - Post on website" 
	capture label variable IC10Q06		"At School - Simulations" 
	capture label variable IC10Q07		"At School - Practice and drilling" 
	capture label variable IC10Q08		"At School - Homework" 
	capture label variable IC10Q09		"At School - Group work" 
	capture label variable IC11Q01		"Maths lessons - Draw graph" 
	capture label variable IC11Q02		"Maths lessons - Calculation with numbers" 
	capture label variable IC11Q03		"Maths lessons - Geometric figures" 
	capture label variable IC11Q04		"Maths lessons - Spreadsheet" 
	capture label variable IC11Q05		"Maths lessons - Algebra" 
	capture label variable IC11Q06		"Maths lessons - Histograms" 
	capture label variable IC11Q07		"Maths lessons - Change in graphs" 
	capture label variable IC22Q01		"Attitudes - Useful for schoolwork" 
	capture label variable IC22Q02		"Attitudes - Homework more fun" 
	capture label variable IC22Q04		"Attitudes - Source of information" 
	capture label variable IC22Q06		"Attitudes - Troublesome" 
	capture label variable IC22Q07		"Attitudes - Not suitable for schoolwork" 
	capture label variable IC22Q08		"Attitudes - Too unreliable" 
	capture label variable EC01Q01		"Miss 2 months of <ISCED 1>" 
	capture label variable EC02Q01		"Miss 2 months of <ISCED 2>" 
	capture label variable EC03Q01		"Future Orientation - Internship" 
	capture label variable EC03Q02		"Future Orientation - Work-site visits" 
	capture label variable EC03Q03		"Future Orientation - Job fair" 
	capture label variable EC03Q04		"Future Orientation - Career advisor at school" 
	capture label variable EC03Q05		"Future Orientation - Career advisor outside school" 
	capture label variable EC03Q06		"Future Orientation - Questionnaire" 
	capture label variable EC03Q07		"Future Orientation - Internet search" 
	capture label variable EC03Q08		"Future Orientation - Tour<ISCED 3-5> institution" 
	capture label variable EC03Q09		"Future Orientation - web search <ISCED 3-5> prog" 
	capture label variable EC03Q10		"Future Orientation - <country specific item>" 
	capture label variable EC04Q01A		"Acquired skills - Find job info - Yes, at school" 
	capture label variable EC04Q01B		"Acquired skills - Find job info - Yes, out of school" 
	capture label variable EC04Q01C		"Acquired skills - Find job info - No, never" 
	capture label variable EC04Q02A		"Acquired skills - Search for job - Yes, at school" 
	capture label variable EC04Q02B		"Acquired skills - Search for job - Yes, out of school" 
	capture label variable EC04Q02C		"Acquired skills - Search for job - No, never" 
	capture label variable EC04Q03A		"Acquired skills - Write resume - Yes, at school" 
	capture label variable EC04Q03B		"Acquired skills - Write resume - Yes, out of school" 
	capture label variable EC04Q03C		"Acquired skills - Write resume - No, never" 
	capture label variable EC04Q04A		"Acquired skills - Job interview - Yes, at school" 
	capture label variable EC04Q04B		"Acquired skills - Job interview - Yes, out of school" 
	capture label variable EC04Q04C		"Acquired skills - Job interview - No, never" 
	capture label variable EC04Q05A		"Acquired skills - ISCED 3-5 programs - Yes, at school" 
	capture label variable EC04Q05B		"Acquired skills - ISCED 3-5 programs - Yes, out of school" 
	capture label variable EC04Q05C		"Acquired skills - ISCED 3-5 programs - No, never" 
	capture label variable EC04Q06A		"Acquired skills - Student financing - Yes, at school" 
	capture label variable EC04Q06B		"Acquired skills - Student financing - Yes, out of school" 
	capture label variable EC04Q06C		"Acquired skills - Student financing - No, never" 
	capture label variable EC05Q01		"First language learned" 
	capture label variable EC06Q01		"Age started learning <test language>" 
	capture label variable EC07Q01		"Language spoken - Mother" 
	capture label variable EC07Q02		"Language spoken - Father" 
	capture label variable EC07Q03		"Language spoken - Siblings" 
	capture label variable EC07Q04		"Language spoken - Best friend" 
	capture label variable EC07Q05		"Language spoken - Schoolmates" 
	capture label variable EC08Q01		"Activities language - Reading" 
	capture label variable EC08Q02		"Activities language - Watching TV" 
	capture label variable EC08Q03		"Activities language - Internet surfing" 
	capture label variable EC08Q04		"Activities language - Writing emails" 
	capture label variable EC09Q03		"Types of support <test language> - remedial lessons" 
	capture label variable EC10Q01		"Amount of support <test language>" 
	capture label variable EC11Q02		"Attend lessons <heritage language> - focused" 
	capture label variable EC11Q03		"Attend lessons <heritage language> - school subjects" 
	capture label variable EC12Q01		"Instruction in <heritage language>" 
	capture label variable ST22Q01		"Acculturation - Mother Immigrant (Filter)" 
	capture label variable ST23Q01		"Acculturation - Enjoy <Host Culture> Friends" 
	capture label variable ST23Q02		"Acculturation - Enjoy <Heritage Culture> Friends" 
	capture label variable ST23Q03		"Acculturation - Enjoy <Host Culture> Celebrations" 
	capture label variable ST23Q04		"Acculturation - Enjoy <Heritage Culture> Celebrations" 
	capture label variable ST23Q05		"Acculturation - Spend Time with <Host Culture> Friends"
	capture label variable ST23Q06		"Acculturation - Spend Time with <Heritage Culture> Friends"
	capture label variable ST23Q07		"Acculturation - Participate in <Host Culture> Celebrations"
	capture label variable ST23Q08		"Acculturation - Participate in <Heritage Culture> Celebrations"
	capture label variable ST24Q01		"Acculturation - Perceived Host-Heritage Cultural Differences - Values"
	capture label variable ST24Q02		"Acculturation - Perceived Host-Heritage Cultural Differences - Mother Treatment" 
	capture label variable ST24Q03		"Acculturation - Perceived Host-Heritage Cultural Differences - Teacher Treatment"
	capture label variable CLCUSE1		"Calculator Use"
	capture label variable CLCUSE301	"Effort-real 1"
	capture label variable CLCUSE302	"Effort-real 2"
	capture label variable DEFFORT		"Difference in Effort"
	capture label variable QUESTID		"Student Questionnaire Form"
	capture label variable BOOKID		"Booklet ID"
	capture label variable EASY			"Standard or simplified set of booklets"
	capture label variable AGE			"Age of student"
	capture label variable GRADE		"Grade compared to modal grade in country"
	capture label variable progn		"Unique national study programme code"
	capture label variable ANXMAT		"Mathematics Anxiety"
	capture label variable ATSCHL		"Attitude towards School: Learning Outcomes" 
	capture label variable ATTLNACT		"Attitude towards School: Learning Activities" 
	capture label variable BELONG		"Sense of Belonging to School" 
	capture label variable BFMJ2		"Father SQ ISEI" 
	capture label variable BMMJ1		"Mother SQ ISEI" 
	capture label variable CLSMAN		"Mathematics Teacher's Classroom Management"
	capture label variable COBN_F		"Country of Birth National Categories- Father" 
	capture label variable COBN_M		"Country of Birth National Categories- Mother" 
	capture label variable COBN_S		"Country of Birth National Categories- Self" 
	capture label variable COGACT		"Cognitive Activation in Mathematics Lessons"
	capture label variable CULTDIST		"Cultural Distance between Host and Heritage Culture" 
	capture label variable CULTPOS		"Cultural Possessions" 
	capture label variable DISCLIMA		"Disciplinary Climate" 
	capture label variable ENTUSE		"ICT Entertainment Use" 
	capture label variable ESCS			"Index of economic, social and cultural status"
	capture label variable EXAPPLM		"Experience with Applied Mathematics Tasks at School"
	capture label variable EXPUREM		"Experience with Pure Mathematics Tasks at School" 
	capture label variable FAILMAT		"Attributions to Failure in Mathematics"
	capture label variable FAMCON		"Familiarity with Mathematical Concepts" 
	capture label variable FAMCONC		"Familiarity with Mathematical Concepts (Signal Detection Adjusted)" 
	capture label variable FAMSTRUC		"Family Structure" 
	capture label variable FISCED		"Educational level of father (ISCED)"
	capture label variable HEDRES		"Home educational resources" 
	capture label variable HERITCUL		"Acculturation: Heritage Culture Oriented Strategies"
	capture label variable HISCED		"Highest educational level of parents" 
	capture label variable HISEI		"Highest parental occupational status" 
	capture label variable HOMEPOS		"Home Possessions" 
	capture label variable HOMSCH		"ICT Use at Home for School-related Tasks" 
	capture label variable HOSTCUL		"Acculturation: Host Culture Oriented Strategies" 
	capture label variable ICTATTNEG	"Attitudes Towards Computers: Limitations of the Computer as a Tool for School Learning"
	capture label variable ICTATTPOS	"Attitudes Towards Computers: Computer as a Tool for School Learning" 
	capture label variable ICTHOME		"ICT Availability at Home" 
	capture label variable ICTSCH		"ICT Availability at School" 
	capture label variable IMMIG		"Immigration status" 
	capture label variable INFOCAR		"Information about Careers"
	capture label variable INFOJOB1		"Information about the Labour Market provided by the School"
	capture label variable INFOJOB2		"Information about the Labour Market provided outside of School"
	capture label variable INSTMOT		"Instrumental Motivation for Mathematics" 
	capture label variable INTMAT		"Mathematics Interest"
	capture label variable ISCEDD		"ISCED designation"
	capture label variable ISCEDL		"ISCED level"
	capture label variable ISCEDO		"ISCED orientation"
	capture label variable LANGCOMM		"Preference for Heritage Language in Conversations with Family and Friends"
	capture label variable LANGN		"Language at home (3-digit code)"
	capture label variable LANGRPPD		"Preference for Heritage Language in Language Reception and Production"
	capture label variable LMINS		"Learning time (minutes per week) - <test language>" 
	capture label variable MATBEH		"Mathematics Behaviour"
	capture label variable MATHEFF		"Mathematics Self-Efficacy"
	capture label variable MATINTFC		"Mathematics Intentions" 
	capture label variable MATWKETH		"Mathematics Work Ethic" 
	capture label variable MISCED		"Educational level of mother (ISCED)"
	capture label variable MMINS		"Learning time (minutes per week)- <Mathematics>" 
	capture label variable MTSUP		"Mathematics Teacher's Support"
	capture label variable OCOD1		"ISCO-08 Occupation code - Mother" 
	capture label variable OCOD2		"ISCO-08 Occupation code - Father" 
	capture label variable OPENPS		"Openness for Problem Solving"
	capture label variable OUTHOURS		"Out-of-School Study Time"
	capture label variable PARED		"Highest parental education in years"
	capture label variable PERSEV		"Perseverance" 
	capture label variable REPEAT		"Grade Repetition"
	capture label variable SCMAT		"Mathematics Self-Concept" 
	capture label variable SMINS		"Learning time (minutes per week) - <Science>" 
	capture label variable STUDREL		"Teacher Student Relations"
	capture label variable SUBNORM		"Subjective Norms in Mathematics"
	capture label variable TCHBEHFA		"Teacher Behaviour: Formative Assessment" 
	capture label variable TCHBEHSO		"Teacher Behaviour: Student Orientation"
	capture label variable TCHBEHTD		"Teacher Behaviour: Teacher-directed Instruction" 
	capture label variable TEACHSUP		"Teacher Support" 
	capture label variable TESTLANG		"Language of the test" 
	capture label variable TIMEINT		"Time of computer use (mins)" 
	capture label variable USEMATH		"Use of ICT in Mathematic Lessons"
	capture label variable USESCH		"Use of ICT at School" 
	capture label variable WEALTH		"Wealth" 
	capture label variable ANCATSCHL	"Attitude towards School: Learning Outcomes (Anchored)"
	capture label variable ANCATTLNACT	"Attitude towards School: Learning Activities (Anchored)"
	capture label variable ANCBELONG	"Sense of Belonging to School (Anchored)"
	capture label variable ANCCLSMAN	"Mathematics Teacher's Classroom Management (Anchored)"
	capture label variable ANCCOGACT	"Cognitive Activation in Mathematics Lessons (Anchored)"
	capture label variable ANCINSTMOT	"Instrumental Motivation for Mathematics (Anchored)"
	capture label variable ANCINTMAT	"Mathematics Interest (Anchored)"
	capture label variable ANCMATWKETH	"Mathematics Work Ethic (Anchored)"
	capture label variable ANCMTSUP		"Mathematics Teacher's Support (Anchored)"
	capture label variable ANCSCMAT		"Mathematics Self-Concept (Anchored)"
	capture label variable ANCSTUDREL	"Teacher Student Relations (Anchored)"
	capture label variable ANCSUBNORM	"Subjective Norms in Mathematics (Anchored)"
	capture label variable PV1MATH		"Plausible value 1 in mathematics"
	capture label variable PV2MATH		"Plausible value 2 in mathematics"
	capture label variable PV3MATH		"Plausible value 3 in mathematics"
	capture label variable PV4MATH		"Plausible value 4 in mathematics"
	capture label variable PV5MATH		"Plausible value 5 in mathematics"
	capture label variable PV1MACC		"Plausible value 1 in content subscale of Maths - Change and Relationships" 
	capture label variable PV2MACC		"Plausible value 2 in content subscale of Maths - Change and Relationships" 
	capture label variable PV3MACC		"Plausible value 3 in content subscale of Maths - Change and Relationships" 
	capture label variable PV4MACC		"Plausible value 4 in content subscale of Maths - Change and Relationships" 
	capture label variable PV5MACC		"Plausible value 5 in content subscale of Maths - Change and Relationships" 
	capture label variable PV1MACQ		"Plausible value 1 in content subscale of Maths - Quantity"
	capture label variable PV2MACQ		"Plausible value 2 in content subscale of Maths - Quantity"
	capture label variable PV3MACQ		"Plausible value 3 in content subscale of Maths - Quantity"
	capture label variable PV4MACQ		"Plausible value 4 in content subscale of Maths - Quantity"
	capture label variable PV5MACQ		"Plausible value 5 in content subscale of Maths - Quantity"
	capture label variable PV1MACS		"Plausible value 1 in content subscale of Maths - Space and Shape"
	capture label variable PV2MACS		"Plausible value 2 in content subscale of Maths - Space and Shape"
	capture label variable PV3MACS		"Plausible value 3 in content subscale of Maths - Space and Shape"
	capture label variable PV4MACS		"Plausible value 4 in content subscale of Maths - Space and Shape"
	capture label variable PV5MACS		"Plausible value 5 in content subscale of Maths - Space and Shape"
	capture label variable PV1MACU		"Plausible value 1 in content subscale of Maths - Uncertainty and Data"
	capture label variable PV2MACU		"Plausible value 2 in content subscale of Maths - Uncertainty and Data"
	capture label variable PV3MACU		"Plausible value 3 in content subscale of Maths - Uncertainty and Data"
	capture label variable PV4MACU		"Plausible value 4 in content subscale of Maths - Uncertainty and Data"
	capture label variable PV5MACU		"Plausible value 5 in content subscale of Maths - Uncertainty and Data"
	capture label variable PV1MAPE		"Plausible value 1 in process subscale of Maths - Employ"
	capture label variable PV2MAPE		"Plausible value 2 in process subscale of Maths - Employ"
	capture label variable PV3MAPE		"Plausible value 3 in process subscale of Maths - Employ"
	capture label variable PV4MAPE		"Plausible value 4 in process subscale of Maths - Employ"
	capture label variable PV5MAPE		"Plausible value 5 in process subscale of Maths - Employ"
	capture label variable PV1MAPF		"Plausible value 1 in process subscale of Maths - Formulate"
	capture label variable PV2MAPF		"Plausible value 2 in process subscale of Maths - Formulate"
	capture label variable PV3MAPF		"Plausible value 3 in process subscale of Maths - Formulate"
	capture label variable PV4MAPF		"Plausible value 4 in process subscale of Maths - Formulate"
	capture label variable PV5MAPF		"Plausible value 5 in process subscale of Maths - Formulate"
	capture label variable PV1MAPI		"Plausible value 1 in process subscale of Maths - Interpret"
	capture label variable PV2MAPI		"Plausible value 2 in process subscale of Maths - Interpret"
	capture label variable PV3MAPI		"Plausible value 3 in process subscale of Maths - Interpret"
	capture label variable PV4MAPI		"Plausible value 4 in process subscale of Maths - Interpret"
	capture label variable PV5MAPI		"Plausible value 5 in process subscale of Maths - Interpret"
	capture label variable PV1READ		"Plausible value 1 in reading"
	capture label variable PV2READ		"Plausible value 2 in reading"
	capture label variable PV3READ		"Plausible value 3 in reading"
	capture label variable PV4READ		"Plausible value 4 in reading"
	capture label variable PV5READ		"Plausible value 5 in reading"
	capture label variable PV1SCIE		"Plausible value 1 in science"
	capture label variable PV2SCIE		"Plausible value 2 in science"
	capture label variable PV3SCIE		"Plausible value 3 in science"
	capture label variable PV4SCIE		"Plausible value 4 in science"
	capture label variable PV5SCIE		"Plausible value 5 in science"
	capture label variable W_FSTUWT		"FINAL STUDENT WEIGHT" 
	capture label variable W_FSTR1		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT1" 
	capture label variable W_FSTR2		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT2" 
	capture label variable W_FSTR3		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT3" 
	capture label variable W_FSTR4		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT4" 
	capture label variable W_FSTR5		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT5" 
	capture label variable W_FSTR6		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT6" 
	capture label variable W_FSTR7		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT7" 
	capture label variable W_FSTR8		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT8" 
	capture label variable W_FSTR9		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT9" 
	capture label variable W_FSTR10		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT10"
	capture label variable W_FSTR11		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT11"
	capture label variable W_FSTR12		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT12"
	capture label variable W_FSTR13		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT13"
	capture label variable W_FSTR14		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT14"
	capture label variable W_FSTR15		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT15"
	capture label variable W_FSTR16		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT16"
	capture label variable W_FSTR17		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT17"
	capture label variable W_FSTR18		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT18"
	capture label variable W_FSTR19		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT19"
	capture label variable W_FSTR20		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT20"
	capture label variable W_FSTR21		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT21"
	capture label variable W_FSTR22		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT22"
	capture label variable W_FSTR23		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT23"
	capture label variable W_FSTR24		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT24"
	capture label variable W_FSTR25		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT25"
	capture label variable W_FSTR26		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT26"
	capture label variable W_FSTR27		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT27"
	capture label variable W_FSTR28		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT28"
	capture label variable W_FSTR29		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT29"
	capture label variable W_FSTR30		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT30"
	capture label variable W_FSTR31		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT31"
	capture label variable W_FSTR32		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT32"
	capture label variable W_FSTR33		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT33"
	capture label variable W_FSTR34		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT34"
	capture label variable W_FSTR35		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT35"
	capture label variable W_FSTR36		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT36"
	capture label variable W_FSTR37		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT37"
	capture label variable W_FSTR38		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT38"
	capture label variable W_FSTR39		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT39"
	capture label variable W_FSTR40		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT40"
	capture label variable W_FSTR41		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT41"
	capture label variable W_FSTR42		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT42"
	capture label variable W_FSTR43		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT43"
	capture label variable W_FSTR44		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT44"
	capture label variable W_FSTR45		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT45"
	capture label variable W_FSTR46		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT46"
	capture label variable W_FSTR47		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT47"
	capture label variable W_FSTR48		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT48"
	capture label variable W_FSTR49		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT49"
	capture label variable W_FSTR50		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT50"
	capture label variable W_FSTR51		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT51"
	capture label variable W_FSTR52		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT52"
	capture label variable W_FSTR53		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT53"
	capture label variable W_FSTR54		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT54"
	capture label variable W_FSTR55		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT55"
	capture label variable W_FSTR56		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT56"
	capture label variable W_FSTR57		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT57"
	capture label variable W_FSTR58		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT58"
	capture label variable W_FSTR59		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT59"
	capture label variable W_FSTR60		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT60"
	capture label variable W_FSTR61		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT61"
	capture label variable W_FSTR62		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT62"
	capture label variable W_FSTR63		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT63"
	capture label variable W_FSTR64		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT64"
	capture label variable W_FSTR65		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT65"
	capture label variable W_FSTR66		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT66"
	capture label variable W_FSTR67		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT67"
	capture label variable W_FSTR68		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT68"
	capture label variable W_FSTR69		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT69"
	capture label variable W_FSTR70		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT70"
	capture label variable W_FSTR71		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT71"
	capture label variable W_FSTR72		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT72"
	capture label variable W_FSTR73		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT73"
	capture label variable W_FSTR74		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT74"
	capture label variable W_FSTR75		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT75"
	capture label variable W_FSTR76		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT76"
	capture label variable W_FSTR77		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT77"
	capture label variable W_FSTR78		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT78"
	capture label variable W_FSTR79		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT79"
	capture label variable W_FSTR80		"FINAL STUDENT REPLICATE BRR-FAY WEIGHT80"
	capture label variable WVARSTRR		"RANDOMIZED FINAL VARIANCE STRATUM (1-80)"
	capture label variable VAR_UNIT		"RANDOMLY ASSIGNED VARIANCE UNIT" 
	capture label variable senwgt_STU	"Senate weight - sum of weight within the country is 1000"
	capture label variable VER_STU		"Date of the database creation"       

/*
			"ALB"  "Albania"
			"ARG"  "Argentina"
			"AUS"  "Australia"
			"AUT"  "Austria"
			"BEL"  "Belgium"
			"BRA"  "Brazil"
			"BGR"  "Bulgaria"
			"CAN"  "Canada"
			"CHL"  "Chile"
			"QCN"  "Shanghai-China"
			"TAP"  "Chinese Taipei"
			"COL"  "Colombia"
			"CRI"  "Costa Rica"
			"HRV"  "Croatia"
			"CZE"  "Czech Republic"
			"DNK"  "Denmark"
			"EST"  "Estonia"
			"FIN"  "Finland"
			"FRA"  "France"
			"DEU"  "Germany"
			"GRC"  "Greece"
			"HKG"  "Hong Kong-China"
			"HUN"  "Hungary"
			"ISL"  "Iceland"
			"IDN"  "Indonesia"
			"IRL"  "Ireland"
			"ISR"  "Israel"
			"ITA"  "Italy"
			"JPN"  "Japan"
			"JOR"  "Jordan"
			"KAZ"  "Kazakhstan"
			"KOR"  "Korea"
			"LVA"  "Latvia"
			"LIE"  "Liechtenstein"
			"LTU"  "Lithuania"
			"LUX"  "Luxembourg"
			"MAC"  "Macao-China"
			"MYS"  "Malaysia"
			"MEX"  "Mexico"
			"MNE"  "Montenegro"
			"NLD"  "Netherlands"
			"NZL"  "New Zealand"
			"NOR"  "Norway"
			"QRS"  "Perm(Russian Federation)"
			"PER"  "Peru"
			"POL"  "Poland"
			"PRT"  "Portugal"
			"QAT"  "Qatar"
			"ROU"  "Romania"
			"RUS"  "Russian Federation"
			"SRB"  "Serbia"
			"SGP"  "Singapore"
			"SVK"  "Slovak Republic"
			"SVN"  "Slovenia"
			"ESP"  "Spain"
			"SWE"  "Sweden"
			"CHE"  "Switzerland"
			"THA"  "Thailand"
			"TUN"  "Tunisia"
			"TUR"  "Turkey"
			"GBR"  "United Kingdom"
			"ARE"  "United Arab Emirates"
			"USA"  "United States of America"
			"URY"  "Uruguay"
			"VNM"  "Viet Nam"
			"QUA"  "Florida (USA)"
			"QUB"  "Connecticut (USA)"
			"QUC"  "Massachusetts (USA)"
			"N/A"  "Not applicable"

*/

		*-------------------------------*
		* 		Has siblings			*	
		*-------------------------------*

		*-Who usually lives at home with you? 
		gen sibs = .
		replace sibs = 0 if inlist(ST11Q03,1,2)==1 	| inlist(ST11Q04,1,2)==1 //Defined if yes/no at least for one.
		replace sibs = 1 if inlist(ST11Q03,1)==1 	| inlist(ST11Q04,1)==1 //Defined as YES if yes at least for one.
	
	*-------------------------------*
	* 		Rename					*	
	*-------------------------------*	
	
	rename senwgt_STU SENWT
	
	*-----------------------------*
	* 3. Save the dataset         *
	*-----------------------------*

		//destring CNTRYID, replace
		gen year = 2012
		compress
		save "$TEMP\COVID\pisa_student_2012.dta", replace


end

capture program drop import_data_2015
program define import_data_2015

	//import spss using "$IN\PISA\2015\CY6_MS_CMB_STU_QQ2.SAV", clear
	import spss using "$IN\PISA\2015\CY07_MSU_STU_QQQ.SAV", clear
	
	gen year = 2015
	compress
	save "$TEMP\COVID\pisa_student_2015.dta", replace


end

capture program drop import_data_2018
program define import_data_2018



	import spss using "$IN\PISA\2018\CY07_MSU_STU_QQQ.SAV", clear
	
	//use "$TEMP\COVID\pisa_student_2018.dta", clear

	
	*- Which language do you usually speak with: My mother
	//ST023Q01TA
	tab ST023Q01TA

	
	
	*- Which language do you usually speak with: My father
	//ST023Q02TA
	tab ST023Q02TA

	
	
	*- Which language do you usually speak with: My brother(s) and/or sister(s)
	//ST023Q03TA
	tab ST023Q03TA
		//Could define based on 'not applicable' not it also includes cases of 'heritage and test language are the same' plus, has similar number of cases than for father or mother.
	tab ST023Q01TA ST023Q03TA
	 
	 
	 
	*- How easy is it for you to talk to the following people about things that really bother you? Your brother(s)
	//WB162Q05HA
	tab WB162Q05HA
	gen brother = inlist(WB162Q05HA,5)==1 if inlist(WB162Q05HA,1,2,3,4,5)
	
	*- How easy is it for you to talk to the following people about things that really bother you? Your sister(s)
	//WB162Q06HA
	tab WB162Q06HA
	gen sister = inlist(WB162Q05HA,5)==1 if inlist(WB162Q05HA,1,2,3,4,5)
	
	
	*- Sibling definition
	gen sibs = (brother==1 | sister==1) if brother!=. & sister!=.
	
	
	*- How often do the following people work with you on your schoolwork? Your brothers and sisters
	//EC155Q03DA

	

	
	
	gen year = 2018
	compress
	save "$TEMP\COVID\pisa_student_2018.dta", replace


end

capture program drop import_data_2022
program define import_data_2022



	import spss using "$IN\PISA\2022\CY08MSP_STU_QQQ	.SAV", clear


	//Country
	ds CNTRYID

	//Test Scores (Plausible Values)
	ds PV*MATH PV*READ PV*SCIE

	//Number of siblings
	tab ST230Q01JA
	gen sibs = inlist(ST230Q01JA,2,3,4)==1 if ST230Q01JA!=.
	
	*-How easy is it for you to talk to the following people about things that really bother you: Your brother(s)
	ds WB162Q05HA
	
	*-How easy is it for you to talk to the following people about things that really bother you: Your sister(s)
	ds WB162Q06HA
	
	tab WB162Q05HA if sibs==1
	tab WB162Q05HA if sibs==0
	tab WB162Q06HA if sibs==1
	tab WB162Q06HA if sibs==0
	//Seems accurate

	//SES
	sum ESCS


	*-----------------------------*
	* x. Save the dataset         *
	*-----------------------------*

	gen year = 2022
	compress

	save "$TEMP\COVID\pisa_student_2022.dta", replace

end

capture program drop import_data_2018_D
program define import_data_2018_D


	import spss using "$IN\PISA\2018-D\CY1MDAI_STU_QQQ.SAV", clear

	//Test Scores (Plausible Values)
	ds PV*MATH PV*READ PV*SCIE
	
	*- Siblings
	tab ST029Q05NA
	gen sibs = inlist(ST029Q05NA,1)==1 if ST029Q05NA!=.
	*-----------------------------*
	* x. Save the dataset         *
	*-----------------------------*

	gen year = 2018
	compress

	save "$TEMP\COVID\pisa_student_2018_D.dta", replace
end

*- Review
capture program drop review
program define review

	use "$TEMP\COVID\pisa_student_2009.dta", clear
	use "$TEMP\COVID\pisa_student_2012.dta", clear
	use "$TEMP\COVID\pisa_student_2015.dta", clear
	use "$TEMP\COVID\pisa_student_2018.dta", clear
	use "$TEMP\COVID\pisa_student_2022.dta", clear

	
	*- Does 2018-D has countries in 2022?
	use "$TEMP\COVID\pisa_student_2018_D.dta", clear
	
	bys CNT: keep if _n==1
	tempfile pisa_2018_D
	save `pisa_2018_D', replace
	
	use "$TEMP\COVID\pisa_student_2022.dta", clear
	
	bys CNT: keep if _n==1
	tempfile pisa_2022
	save `pisa_2022', replace
	
	merge 1:1 CNT using `pisa_2018_D'
	
	tab CNT if _m==3
	
	
end

*- Append years
capture program drop append_years
program define append_years

	use CNT CNTRYID sibs year PV*MATH PV*READ PV*SCIE ESCS OECD SENWT using "$TEMP\COVID\pisa_student_2022.dta", clear
	append using "$TEMP\COVID\pisa_student_2018.dta", keep(CNT CNTRYID sibs year PV*MATH PV*READ PV*SCIE ESCS OECD SENWT)
	append using "$TEMP\COVID\pisa_student_2018_D.dta", keep(CNT CNTRYID sibs year PV*MATH PV*READ PV*SCIE ESCS OECD SENWT)
	//append using "$TEMP\COVID\pisa_student_2015.dta", keep(CNT /*sibs*/ year PV*MATH PV*READ PV*SCIE OECD)
	append using "$TEMP\COVID\pisa_student_2012.dta", keep(CNT /*CNTRYID*/ sibs year PV*MATH PV*READ PV*SCIE ESCS OECD SENWT)
	append using "$TEMP\COVID\pisa_student_2009.dta", keep(CNT CNTRYID sibs year PV*MATH PV*READ PV*SCIE ESCS OECD SENWT)


	*-----------------------------*
	* x. Keep countries with information pre and post
	*-----------------------------*
	/*
	local n_years = 4

	bysort CNT (year): 	gen tag = year != year[_n-1]   // tag unique years
	bysort CNT (year): 	replace tag = 1 if _n == 1      // make sure first obs is tagged
	
	//keep if CNTRYID==383
	bysort CNT:			egen n_years = total(tag)
	keep if n_years == `n_years' 
	*/
	
	bys CNT: egen min_year = min(year)
	bys CNT: egen max_year = max(year)	
	//keep if max_year==2022 & min_year<2022

		
	bys CNT: egen min_year_sibs = min(cond(sibs!=.,year,.))
	bys CNT: egen max_year_sibs = max(cond(sibs!=.,year,.))
	
	
	*- Rename/Relabel
	label define OECD 0 "Non-OECD" 1 "OECD"
	label values OECD OECD
	
	*-----------------------------*
	* x. Fill country name when missing
	*-----------------------------*

	//For years without CNTRYID var (2012)
	bysort CNT (year): replace CNTRYID = CNTRYID[_N]
	
	//For changes in OECD status. We assign latest
	bysort CNT (OECD): replace OECD = OECD[_N]	

	compress
	
	save "$TEMP\COVID_pisa_append", replace

end 



capture program drop descriptive
program define descriptive
	
	
	use "$TEMP\COVID_pisa_append", clear
	
	keep if year==2022
	
	twoway 	/// 
			(histogram ESCS if sibs==0 & abs(ESCS)<3.5, width(0.2) percent  lcolor(blue%50) fcolor(blue%20)) ///
			(histogram ESCS if sibs==1 & abs(ESCS)<3.5, width(0.2) percent lcolor(red%50) fcolor(red%20)) ///
			, ///
			xtitle("Index of economic, social and cultural status") ///
			ytitle("Percent") ///
			legend(order(1 "Only child sample" 2 "Sibling sample") pos(6) col(2))
				capture qui graph export "$FIGURES\Descriptive\PISA_SES_2022.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_SES_2022.pdf", replace	
	/*
	twoway 	/// 
			(kdensity ESCS if sibs==0) ///
			(kdensity ESCS if sibs==1) ///
			, ///
			xtitle("Index of economic, social and cultural status") ///
			ytitle("Density")
			legend(order(1 "Only child sample" 2 "Sibling sample"))	
	*/
end 


capture program drop analyze_2009_2012_vs_2022
program define analyze_2009_2012_vs_2022

	use  "$TEMP\COVID_pisa_append", clear
	
	tab year sibs, row nofreq
	keep if year==2009 | year==2012 | year==2022
	keep if sibs!=.
	
	*- Standardize results by base year:
	foreach v of var PV*MATH PV*READ PV*SCIE {
		sum `v' if year==2009, de
		local m = r(mean)
		local sd = r(sd)
		replace `v' = (`v'-`m')/`sd'
	}
	
	*- Has observations for 3 years
	local n_years = 3

	bysort CNT (year): 	gen tag = year != year[_n-1]   // tag unique years
	bysort CNT (year): 	replace tag = 1 if _n == 1      // make sure first obs is tagged
	bysort CNT:			egen n_years = total(tag)
	keep if n_years == `n_years' 


	//collapse PV1MATH, by(CNTRYID year)
	
	//Overall average
	preserve
		collapse PV*MATH PV*READ PV*SCIE [iw=SENWT], by(year OECD)
		*graph hbar (mean) PV1MATH, over(CNTRYID, sort(1) label(labsize(*0.3)))  
		rename (PV*MATH PV*READ PV*SCIE) (PV*MATH_all_avg PV*READ_all_avg PV*SCIE_all_avg)
		tempfile PV_all_avg
		save `PV_all_avg', replace
	restore	
	
	//Overall sib averages
	preserve
		collapse PV*MATH PV*READ PV*SCIE [iw=SENWT], by(sibs year OECD)
		*graph hbar (mean) PV1MATH, over(CNTRYID, sort(1) label(labsize(*0.3)))  
		rename (PV*MATH PV*READ PV*SCIE) (PV*MATH_all_avg PV*READ_all_avg PV*SCIE_all_avg)
		tempfile PV_all_sibs_avg
		save `PV_all_sibs_avg', replace
	restore		

	//Country averages
	preserve
		collapse PV*MATH PV*READ PV*SCIE [iw=SENWT], by(CNTRYID year)
		*graph hbar (mean) PV1MATH, over(CNTRYID, sort(1) label(labsize(*0.3)))  
		rename (PV*MATH PV*READ PV*SCIE) (PV*MATH_avg PV*READ_avg PV*SCIE_avg)
		reshape wide PV*MATH_avg PV*READ_avg PV*SCIE_avg, i(CNTRYID) j(year)
		tempfile PV_CNTRYID
		save `PV_CNTRYID', replace
	restore


	//How is the gap by # children in each country?
	preserve
		collapse PV*MATH PV*READ PV*SCIE  [iw=SENWT], by(CNTRYID year sibs)
		foreach v of var PV*MATH PV*READ PV*SCIE {
			bys CNTRYID year (sibs): gen gap_`v' = `v'-`v'[1] if _n!=1
			}
		keep if sibs==1
		tempfile gap_long_PV_CNTRYID
		save `gap_long_PV_CNTRYID', replace		
		drop PV*MATH PV*READ PV*SCIE		
		reshape wide gap*, i(CNTRYID) j(year)
		tempfile gap_wide_PV_CNTRYID
		save `gap_wide_PV_CNTRYID', replace	
	restore

		
	local ytitle_PV1MATH = "Mathematics test score"
	local ytitle_PV1READ = "Reading test score"
	local ytitle_PV1SCIE = "Science test score"	

	local ytitle_gap_PV1MATH = "Siblings - Only Child Gap (Mathematics)"
	local ytitle_gap_PV1READ = "Siblings - Only Child Gap (Reading)"
	local ytitle_gap_PV1SCIE = "Siblings - Only Child Gap (Science)"	
	
	
	*- 1.  Overall Trends in performance
	preserve
		use `PV_all_avg', clear
		append using `PV_all_sibs_avg'
		*- Scatter plot
		foreach subj in "PV1MATH" "PV1READ" /*"PV1SCIE"*/ {
			twoway 	///
					(line `subj'_all_avg year if sibs==0, lcolor("${blue_2}")) ///
					(line `subj'_all_avg year if sibs==1, lcolor("${red_2}")) ///
					/// (line `subj'_all_avg year if sibs==., lcolor(gs0)) ///
					(scatter `subj'_all_avg year if sibs==0, mcolor("${blue_2}")) ///
					(scatter `subj'_all_avg year if sibs==1, mcolor("${red_2}")) ///
					/// (scatter `subj'_all_avg year if sibs==., mcolor(gs0)) ///
					, /// 
					legend(order(/*3 "Total"*/ 1 "Only childs sample" 2 "Sibling sample") col(3)) ///
					ytitle(`ytitle_`subj'') ///
					xtitle(Year) ///
					yline(0, lcolor(gs8)) ///
					ylabel(-.5(.1).5) ///
					xlabel(2009 2012 2022) ///
					by(OECD, legend(pos(6)) note(""))
				capture qui graph export "$FIGURES\Descriptive\PISA_`subj'_2009_2022.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_`subj'_2009_2022.pdf", replace
		}
	restore
	
	*- 2.  Gap Ranking
	preserve
		
		bys CNTRYID: keep if _n==1
		keep CNTRYID OECD
		
		merge m:1 CNTRYID using `PV_CNTRYID', keep(master match) nogen
		merge m:1 CNTRYID using `gap_wide_PV_CNTRYID', keep(master match) nogen
		
		*graph hbar (mean) gap, over(CNTRYID, sort(1) label(labsize(*0.3)))  
		/*
		merge m:1 CNTRYID using `PV1MATH_CNTRYID'


		scatter gap PV1MATH_avg
		*/
		foreach subj in "PV1MATH" "PV1READ" /*"PV1SCIE"*/ {
			foreach year in "2009" "2012" "2022" {
			graph hbar (mean) gap_`subj'`year', over(CNTRYID, sort(1) label(labsize(*0.3)))  ytitle(`ytitle_gap_`subj'')
					capture qui graph export "$FIGURES\Descriptive\PISA_gap_ranking_`subj'_`y'.png", replace			
					capture qui graph export "$FIGURES\Descriptive\PISA_gap_ranking_`subj'_`y'.pdf", replace	
			}
		}
		/*
		gen gap_PV1MATH_09_22 = gap_PV1MATH2022 - gap_PV1MATH2009
		gen gap_PV1MATH_12_22 = gap_PV1MATH2022 - gap_PV1MATH2012
		histogram gap_PV1MATH_09_22
		histogram gap_PV1MATH_12_22
		*/
	restore

	*- 3. Gap plot
	preserve
		
		bys CNTRYID year: keep if _n==1
		keep CNT CNTRYID OECD year
		merge m:1 CNTRYID  using `PV_CNTRYID', keep(master match) nogen	
		merge m:1 CNTRYID year using `gap_long_PV_CNTRYID', keep(master match) nogen	
		//foreach year in "2009" "2012" {
		foreach subj in "PV1MATH" "PV1READ" /*"PV1SCIE"*/ {
			
			//local subj = "PV1MATH"
			*- Box plot
			graph box gap_`subj', over(year) by(OECD) yline(0, lcolor(gs8))
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_box_2009_2022.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_box_2009_2022.pdf", replace		
	
			*- Scatter plot
			twoway 	///
					(scatter gap_`subj' year if CNT!="PER", mcolor("${blue_2}%20")) ///
					(scatter gap_`subj' year if CNT=="PER", mcolor("${red_2}")) ///
					, ///
					/// legend(order(1 "OECD" 2 "Non-OECD") col(2) pos(6)) ///
					legend(off) ///
					ytitle(`ytitle_gap_`subj'') ///
					yline(0, lcolor(gs8)) ///
					ylabel(-.5(.1).5) ///
					xlabel(2009 2012 2022) ///
					xtitle("Year") ///
					note("")
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_scatter_2009_2022.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_scatter_2009_2022.pdf", replace		
			}
		
	restore
	

	*- 3. DID raw vs school closure
	preserve	
		bys CNTRYID year: keep if _n==1
		keep CNT CNTRYID OECD year
		merge m:1 CNTRYID  using `PV_CNTRYID', keep(master match) nogen	
		merge m:1 CNTRYID year using `gap_long_PV_CNTRYID', keep(master match) nogen	
		
		keep CNT CNTRYID OECD year gap_PV1MATH gap_PV1READ
		reshape wide gap*, i(CNTRYID OECD) j(year)
		
		merge 1:1 CNT using "$TEMP\COVID\school_closure_country", keep(master match)
		
		order CNT, first
		
		
		
		rename Weeksfullyclosed 	weeks_full
		rename Weekspartiallyopen 	weeks_partial
		
		foreach subj in "PV1MATH" "PV1READ" {
			foreach policy in "full" "partial" "not_fully_open" {
				gen did_`subj' = gap_`subj'2022 - gap_`subj'2012
				twoway 	///
						(scatter did_`subj' weeks_`policy' if CNT!="PER", mlabel(CNT)) ///
						(scatter did_`subj' weeks_`policy' if inlist(CNT,"NLD","USA","CHL","COL","PER"), mlabel(CNT)) ///
						, ///
						xtitle("Weeks schools fully closed") ///
						ytitle("Raw DID `ytitle_`subj'' (Change in sibling - only child gap)") ///
						yline(0, lcolor(gs8)) ///
						by(OECD, legend(off) note(""))
				capture qui graph export "$FIGURES\Descriptive\PISA_raw_DID_`subj'_`policy'.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_raw_DID_`subj'_`policy'.pdf", replace		
			}
		}
	restore	
	
	*- Scatter by country
	preserve
		//foreach year in "2009" "2012" {
		foreach subj in "PV1MATH" "PV1READ" /*"PV1SCIE"*/ {
			
			//local subj = "PV1MATH"
			*- Box plot
			graph box gap_`subj', over(year) by(OECD) yline(0, lcolor(gs8))
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_box_2009_2022.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_box_2009_2022.pdf", replace		
	
			*- Scatter plot
			twoway 	///
					(scatter gap_`subj' year if CNT!="PER", mcolor("${blue_2}%20")) ///
					(scatter gap_`subj' year if CNT=="PER", mcolor("${red_2}")) ///
					, ///
					/// legend(order(1 "OECD" 2 "Non-OECD") col(2) pos(6)) ///
					legend(off) ///
					ytitle(`ytitle_gap_`subj'') ///
					yline(0, lcolor(gs8)) ///
					ylabel(-.5(.1).5) ///
					xlabel(2009 2012 2022) ///
					xtitle("Year") ///
					note("")
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_scatter_2009_2022.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_scatter_2009_2022.pdf", replace		
			}
		
	restore

		

	
	capture erase "$TEMP\COVID\erase_test.dta"
	
end


capture program drop analyze_2018_D_vs_2022
program define analyze_2018_D_vs_2022

		use  "$TEMP\COVID_pisa_append", clear
			
		keep if sibs!=.

		//collapse PV1MATH, by(CNTRYID year)
		keep if min_year_sibs==2018 
		keep if max_year_sibs==2022
		
		tab CNTRYID
		//  Cambodia  Guatemala   Paraguay
		
		*- Standardize results by base year:
		foreach v of var PV*MATH PV*READ PV*SCIE {
			sum `v' if year==2018, de
			local m = r(mean)
			local sd = r(sd)
			replace `v' = (`v'-`m')/`sd'
		}	
		

		
		//Overall average
		preserve
			collapse PV*MATH PV*READ PV*SCIE [iw=SENWT], by(year OECD)
			*graph hbar (mean) PV1MATH, over(CNTRYID, sort(1) label(labsize(*0.3)))  
			rename (PV*MATH PV*READ PV*SCIE) (PV*MATH_all_avg PV*READ_all_avg PV*SCIE_all_avg)
			tempfile PV_all_avg
			save `PV_all_avg', replace
		restore	
		
		//Overall sib averages
		preserve
			collapse PV*MATH PV*READ PV*SCIE [iw=SENWT], by(sibs year OECD)
			*graph hbar (mean) PV1MATH, over(CNTRYID, sort(1) label(labsize(*0.3)))  
			rename (PV*MATH PV*READ PV*SCIE) (PV*MATH_all_avg PV*READ_all_avg PV*SCIE_all_avg)
			tempfile PV_all_sibs_avg
			save `PV_all_sibs_avg', replace
		restore		
		
		//Country sib averages
		preserve
			collapse PV*MATH PV*READ PV*SCIE [iw=SENWT], by(CNTRYID sibs year OECD)
			*graph hbar (mean) PV1MATH, over(CNTRYID, sort(1) label(labsize(*0.3)))  
			rename (PV*MATH PV*READ PV*SCIE) (PV*MATH_avg PV*READ_avg PV*SCIE_avg)
			tempfile PV_country_sibs_avg
			save `PV_country_sibs_avg', replace
		restore	
		
		//Country averages
		preserve
			collapse PV*MATH PV*READ PV*SCIE, by(CNTRYID year)
			*graph hbar (mean) PV1MATH, over(CNTRYID, sort(1) label(labsize(*0.3)))  
			rename (PV*MATH PV*READ PV*SCIE) (PV*MATH_avg PV*READ_avg PV*SCIE_avg)
			reshape wide PV*MATH_avg PV*READ_avg PV*SCIE_avg, i(CNTRYID) j(year)
			tempfile PV_CNTRYID
			save `PV_CNTRYID', replace
		restore

		//How is the gap by # children in each country?
		preserve
			collapse PV*MATH PV*READ PV*SCIE /*[iw=SENWT]*/, by(CNTRYID year sibs)
			foreach v of var PV*MATH PV*READ PV*SCIE {
				bys CNTRYID year (sibs): gen gap_`v' = `v'-`v'[1] if _n!=1
				}
			keep if sibs==1
			tempfile gap_long_PV_CNTRYID
			save `gap_long_PV_CNTRYID', replace		
			drop PV*MATH PV*READ PV*SCIE		
			reshape wide gap*, i(CNTRYID) j(year)
			tempfile gap_wide_PV_CNTRYID
			save `gap_wide_PV_CNTRYID', replace	
		restore
		
		
		*- 1.  Overall Trends in performance
		preserve
			use `PV_all_avg', clear
			append using `PV_all_sibs_avg'
			*- Scatter plot
			foreach subj in "PV1MATH" "PV1READ" "PV1SCIE" {
				twoway 	///
						(line `subj'_all_avg year if sibs==0, lcolor("${blue_2}")) ///
						(line `subj'_all_avg year if sibs==1, lcolor("${red_2}")) ///
						/// (line `subj'_all_avg year if sibs==., lcolor(gs0)) ///
						(scatter `subj'_all_avg year if sibs==0, mcolor("${blue_2}")) ///
						(scatter `subj'_all_avg year if sibs==1, mcolor("${red_2}")) ///
						/// (scatter `subj'_all_avg year if sibs==., mcolor(gs0)) ///
						, /// 
						legend(order(/*3 "Total"*/ 1 "Only childs sample" 2 "Sibling sample") col(3) pos(6)) ///
						ytitle(`ytitle_`subj'') ///
						xtitle(Year) ///
						yline(0, lcolor(gs8)) ///
						ylabel(-.5(.1).5) ///
						xlabel(2018 2022) 
					capture qui graph export "$FIGURES\Descriptive\PISA_`subj'_2018_2022.png", replace			
					capture qui graph export "$FIGURES\Descriptive\PISA_`subj'_2018_2022.pdf", replace
			}
		restore	
		
		*- 2. Country sibling averages
		preserve
			use `PV_country_sibs_avg', clear
			//append using `PV_all_sibs_avg'
			
			local ytitle_PV1MATH = "Mathematics"
			local ytitle_PV1READ = "Reading"
			local ytitle_PV1SCIE = "Science"		
		
			*- Scatter plot
			foreach subj in "PV1MATH" "PV1READ" "PV1SCIE" {
				twoway 	///
						(line `subj'_avg year if sibs==0, lcolor("${blue_2}")) ///
						(line `subj'_avg year if sibs==1, lcolor("${red_2}")) ///
						/// (line `subj'_avg year if sibs==., lcolor(gs0)) ///
						(scatter `subj'_avg year if sibs==0, mcolor("${blue_2}")) ///
						(scatter `subj'_avg year if sibs==1, mcolor("${red_2}")) ///
						/// (scatter `subj'_avg year if sibs==., mcolor(gs0)) ///
						, /// 
						legend(order(/*3 "Total"*/ 1 "Only childs sample" 2 "Sibling sample") col(3)) ///
						ytitle(`ytitle_`subj'') ///
						xtitle(Year) ///
						yline(0, lcolor(gs8)) ///
						ylabel(-.5(.1).5) ///
						xlabel(2018 2022) ///
						by(CNTRYID, col(3) legend(pos(6)) note(""))
					capture qui graph export "$FIGURES\Descriptive\PISA_country_`subj'_2018_2022.png", replace			
					capture qui graph export "$FIGURES\Descriptive\PISA_country_`subj'_2018_2022.pdf", replace
			}
		restore	
	
	preserve
		
		bys CNTRYID: keep if _n==1
		keep CNTRYID
		
		merge m:1 CNTRYID using `PV_CNTRYID', keep(master match) nogen
		merge m:1 CNTRYID using `gap_wide_PV_CNTRYID', keep(master match) nogen
		
		*graph hbar (mean) gap, over(CNTRYID, sort(1) label(labsize(*0.3)))  
		/*
		merge m:1 CNTRYID using `PV1MATH_CNTRYID'


		scatter gap PV1MATH_avg
		*/

		graph hbar (mean) gap_PV1MATH2018, over(CNTRYID, sort(1) label(labsize(*0.3)))  
		graph hbar (mean) gap_PV1MATH2022, over(CNTRYID, sort(1) label(labsize(*0.3)))  
		gen gap_PV1MATH = gap_PV1MATH2022 - gap_PV1MATH2018
		histogram gap_PV1MATH
	restore

	
	preserve
		bys CNTRYID year: keep if _n==1
		keep CNT CNTRYID year
		merge m:1 CNTRYID  using `PV_CNTRYID', keep(master match) nogen	
		merge m:1 CNTRYID year using `gap_long_PV_CNTRYID', keep(master match) nogen	
		
		foreach subj in "PV1MATH" "PV1READ" /*"PV1SCIE"*/ {
			
			//local subj = "PV1MATH"
		
			local ytitle_gap_PV1MATH = "Siblings - Only Child Gap (Mathematics)"
			local ytitle_gap_PV1READ = "Siblings - Only Child Gap (Reading)"
			local ytitle_gap_PV1SCIE = "Siblings - Only Child Gap (Science)"
			
			twoway 	///
					(line gap_`subj' year if CNT=="KHM", lcolor("${red_2}")) ///
					(line gap_`subj' year if CNT=="GTM", lcolor("${blue_2}")) ///
					(line gap_`subj' year if CNT=="PRY", lcolor("${blue_4}")) ///
					(scatter gap_`subj' year if CNT=="KHM", mcolor("${red_2}")) ///
					(scatter gap_`subj' year if CNT=="GTM", mcolor("${blue_2}")) ///
					(scatter gap_`subj' year if CNT=="PRY", mcolor("${blue_4}")) ///					
					, ///
					legend(order(1 "Cambodia" 2 "Guatemala" 3 "Paraguay") col(3) pos(6)) ///
					ytitle(`ytitle_gap_`subj'') ///
					yline(0, lcolor(gs8)) ///
					ylabel(-.2(.1).4) ///
					xlabel(2018 2022)
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_2018D_2022.png", replace			
				capture qui graph export "$FIGURES\Descriptive\PISA_gap_`subj'_2018D_2022.pdf", replace		
			}
	restore
	
	capture erase "$TEMP\COVID\erase_test.dta"
	
end



main
